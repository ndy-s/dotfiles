"use strict";var Nc=Object.create;var Vr=Object.defineProperty;var Qc=Object.getOwnPropertyDescriptor;var Vc=Object.getOwnPropertyNames;var Jc=Object.getPrototypeOf,Hc=Object.prototype.hasOwnProperty;var er=(r,t)=>()=>(r&&(t=r(r=0)),t);var Me=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Qn=(r,t)=>{for(var n in t)Vr(r,n,{get:t[n],enumerable:!0})},Cs=(r,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Vc(t))!Hc.call(r,o)&&o!==n&&Vr(r,o,{get:()=>t[o],enumerable:!(s=Qc(t,o))||s.enumerable});return r};var X=(r,t,n)=>(n=r!=null?Nc(Jc(r)):{},Cs(t||!r||!r.__esModule?Vr(n,"default",{value:r,enumerable:!0}):n,r)),Gc=r=>Cs(Vr({},"__esModule",{value:!0}),r);var Xr=Me(oe=>{"use strict";var Hs=oe&&oe.__awaiter||function(r,t,n,s){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function y(h){try{b(s.next(h))}catch(k){l(k)}}function f(h){try{b(s.throw(h))}catch(k){l(k)}}function b(h){h.done?c(h.value):o(h.value).then(y,f)}b((s=s.apply(r,t||[])).next())})};Object.defineProperty(oe,"__esModule",{value:!0});oe.HttpError=oe.optimistic=oe.okify=oe.ok=oe.SUCCESS_CODES=oe.handle=void 0;function lu(r,t){return Hs(this,void 0,void 0,function*(){let{status:n,data:s,headers:o}=yield r,c=t[n];if(c)return c(s);if(t.default)return t.default(n,s);throw new rr(n,s,o)})}oe.handle=lu;oe.SUCCESS_CODES=[200,201,202,204];function Gs(r){return Hs(this,void 0,void 0,function*(){let t=yield r;if(oe.SUCCESS_CODES.some(n=>n==t.status))return t.data;throw new rr(t.status,t.data,t.headers)})}oe.ok=Gs;function Ys(r){return(...t)=>Gs(r(...t))}oe.okify=Ys;function du(r){let t={};return Object.entries(r).forEach(([n,s])=>{t[n]=typeof s=="function"?Ys(s):s}),t}oe.optimistic=du;var rr=class extends Error{constructor(t,n,s){super(`Error: ${t}`),this.status=t,this.data=n,this.headers=s}};oe.HttpError=rr});var ca=Me(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.joinUrl=fe.stripUndefined=fe.delimited=fe.encode=fe.allowReserved=fe.encodeReserved=void 0;fe.encodeReserved=[encodeURIComponent,encodeURIComponent];fe.allowReserved=[encodeURIComponent,encodeURI];function eo(r,t=","){let n=(s,o)=>{let c=r[o%r.length];return typeof s>"u"?"":typeof s=="object"?Array.isArray(s)?s.map(c).join(t):Object.entries(s).reduce((y,f)=>[...y,...f],[]).map(c).join(t):c(String(s))};return(s,...o)=>s.reduce((c,l,y)=>`${c}${l}${n(o[y],y)}`,"")}fe.encode=eo;function yu(r=","){return(t,n=fe.encodeReserved)=>Object.entries(t).filter(([,s])=>s!==void 0).map(([s,o])=>eo(n,r)`${s}=${o}`).join("&")}fe.delimited=yu;function gu(r){return r&&JSON.parse(JSON.stringify(r))}fe.stripUndefined=gu;function Su(...r){return r.filter(Boolean).map((t,n)=>n===0?t:t.replace(/^\/+/,"")).map((t,n,s)=>n===s.length-1?t:t.replace(/\/+$/,"")).join("/")}fe.joinUrl=Su});var ua=Me(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.space=ce.pipe=ce.form=ce.json=ce.explode=ce.deep=ce.query=void 0;var Le=ca();function wu(...r){let t=r.filter(Boolean).join("&");return t&&`?${t}`}ce.query=wu;function _u(r,[t,n]=Le.encodeReserved){let s=(0,Le.encode)([l=>l,t]),o=(0,Le.encode)([l=>l,n]),c=(l,y="")=>Object.entries(l).filter(([,f])=>f!==void 0).map(([f,b])=>{let h=Array.isArray(l)?"":f,k=y?s`${y}[${h}]`:f;return typeof b=="object"?c(b,k):o`${k}=${b}`}).join("&");return c(r)}ce.deep=_u;function to(r,t=Le.encodeReserved){let n=(0,Le.encode)(t);return Object.entries(r).filter(([,s])=>s!==void 0).map(([s,o])=>Array.isArray(o)?o.map(c=>n`${s}=${c}`).join("&"):typeof o=="object"?to(o,t):n`${s}=${o}`).join("&")}ce.explode=to;function Ou(r,t=Le.encodeReserved){let n=(0,Le.encode)(t);return Object.entries(r).filter(([,s])=>s!==void 0).map(([s,o])=>{let c=JSON.stringify(o);return n`${s}=${c}`}).join("&")}ce.json=Ou;ce.form=(0,Le.delimited)();ce.pipe=(0,Le.delimited)("|");ce.space=(0,Le.delimited)("%20")});var no=Me(he=>{"use strict";var ku=he&&he.__createBinding||(Object.create?(function(r,t,n,s){s===void 0&&(s=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(r,s,o)}):(function(r,t,n,s){s===void 0&&(s=n),r[s]=t[n]})),Eu=he&&he.__setModuleDefault||(Object.create?(function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}):function(r,t){r.default=t}),Ru=he&&he.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&ku(t,r,n);return Eu(t,r),t},tn=he&&he.__awaiter||function(r,t,n,s){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function y(h){try{b(s.next(h))}catch(k){l(k)}}function f(h){try{b(s.throw(h))}catch(k){l(k)}}function b(h){h.done?c(h.value):o(h.value).then(y,f)}b((s=s.apply(r,t||[])).next())})},rn=he&&he.__rest||function(r,t){var n={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&t.indexOf(s)<0&&(n[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(n[s[o]]=r[s[o]]);return n};Object.defineProperty(he,"__esModule",{value:!0});he.runtime=void 0;var xu=Ru(ua()),ro=ca(),$u=Xr();function Pu(r){function t(f,b){return tn(this,void 0,void 0,function*(){let h=yield o(f,b),k;try{k=yield h.text()}catch{}return{status:h.status,headers:h.headers,contentType:h.headers.get("content-type"),data:k}})}function n(f,b={}){return tn(this,void 0,void 0,function*(){let{status:h,headers:k,contentType:_,data:E}=yield t(f,Object.assign(Object.assign({},b),{headers:Object.assign({Accept:"application/json"},b.headers)}));return(_?_.includes("json"):!1)?{status:h,headers:k,data:E?JSON.parse(E):null}:{status:h,headers:k,data:E}})}function s(f,b={}){return tn(this,void 0,void 0,function*(){let h=yield o(f,b),k;try{k=yield h.blob()}catch{}return{status:h.status,headers:h.headers,data:k}})}function o(f,b={}){return tn(this,void 0,void 0,function*(){let h=Object.assign(Object.assign({},r),b),{baseUrl:k,headers:_,fetch:E}=h,O=rn(h,["baseUrl","headers","fetch"]),R=(0,ro.joinUrl)(k,f);return yield(E||fetch)(R,Object.assign(Object.assign({},O),{headers:(0,ro.stripUndefined)(Object.assign(Object.assign({},r.headers),_))}))})}function c(f){return f?.match(/\bjson\b/i)?f:"application/json"}function l(f){return f?.startsWith("application/x-www-form-urlencoded")?f:"application/x-www-form-urlencoded"}function y(f){return f?.startsWith("multipart/form-data")?f:"multipart/form-data"}return{ok:$u.ok,fetchText:t,fetchJson:n,fetchBlob:s,json(f){var{body:b,headers:h}=f,k=rn(f,["body","headers"]);return Object.assign(Object.assign(Object.assign({},k),b!=null&&{body:JSON.stringify(b)}),{headers:Object.assign(Object.assign({},h),{"Content-Type":c(String(h?.["Content-Type"]))})})},form(f){var{body:b,headers:h}=f,k=rn(f,["body","headers"]);return Object.assign(Object.assign(Object.assign({},k),b!=null&&{body:xu.form(b)}),{headers:Object.assign(Object.assign({},h),{"Content-Type":l(String(h?.["Content-Type"]))})})},multipart(f){var{body:b,headers:h}=f,k=rn(f,["body","headers"]);if(b==null)return k;let _=new(r.formDataConstructor||k.formDataConstructor||FormData),E=(O,R)=>{typeof R=="string"||R instanceof Blob?_.append(O,R):_.append(O,new Blob([JSON.stringify(R)],{type:"application/json"}))};return Object.entries(b).forEach(([O,R])=>{Array.isArray(R)?R.forEach(P=>E(O,P)):E(O,R)}),Object.assign(Object.assign({},k),{body:_,headers:Object.assign(Object.assign({},h),{"Content-Type":y(String(h?.["Content-Type"]))})})}}}he.runtime=Pu});var co=Me((nn,io)=>{(function(r,t){typeof nn=="object"&&typeof io<"u"?t(nn):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.WebStreamsPolyfill={}))})(nn,(function(r){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let o=s();function c(e){return typeof e=="object"&&e!==null||typeof e=="function"}let l=n,y=Promise,f=Promise.prototype.then,b=Promise.resolve.bind(y),h=Promise.reject.bind(y);function k(e){return new y(e)}function _(e){return b(e)}function E(e){return h(e)}function O(e,a,i){return f.call(e,a,i)}function R(e,a,i){O(O(e,a,i),void 0,l)}function P(e,a){R(e,a)}function j(e,a){R(e,void 0,a)}function z(e,a,i){return O(e,a,i)}function W(e){O(e,void 0,l)}let $=(()=>{let e=o&&o.queueMicrotask;if(typeof e=="function")return e;let a=_(void 0);return i=>O(a,i)})();function L(e,a,i){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,a,i)}function I(e,a,i){try{return _(L(e,a,i))}catch(u){return E(u)}}let ne=16384;class ee{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(a){let i=this._back,u=i;i._elements.length===ne-1&&(u={_elements:[],_next:void 0}),i._elements.push(a),u!==i&&(this._back=u,i._next=u),++this._size}shift(){let a=this._front,i=a,u=this._cursor,p=u+1,g=a._elements,w=g[u];return p===ne&&(i=a._next,p=0),--this._size,this._cursor=p,a!==i&&(this._front=i),g[u]=void 0,w}forEach(a){let i=this._cursor,u=this._front,p=u._elements;for(;(i!==p.length||u._next!==void 0)&&!(i===p.length&&(u=u._next,p=u._elements,i=0,p.length===0));)a(p[i]),++i}peek(){let a=this._front,i=this._cursor;return a._elements[i]}}function nt(e,a){e._ownerReadableStream=a,a._reader=e,a._state==="readable"?ue(e):a._state==="closed"?U(e):ae(e,a._storedError)}function Te(e,a){let i=e._ownerReadableStream;return Ae(i,a)}function Y(e){e._ownerReadableStream._state==="readable"?se(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):F(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function J(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function ue(e){e._closedPromise=k((a,i)=>{e._closedPromise_resolve=a,e._closedPromise_reject=i})}function ae(e,a){ue(e),se(e,a)}function U(e){ue(e),K(e)}function se(e,a){e._closedPromise_reject!==void 0&&(W(e._closedPromise),e._closedPromise_reject(a),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function F(e,a){ae(e,a)}function K(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let te=t("[[AbortSteps]]"),qe=t("[[ErrorSteps]]"),Je=t("[[CancelSteps]]"),le=t("[[PullSteps]]"),pe=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},bn=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function yn(e){return typeof e=="object"||typeof e=="function"}function ve(e,a){if(e!==void 0&&!yn(e))throw new TypeError(`${a} is not an object.`)}function ge(e,a){if(typeof e!="function")throw new TypeError(`${a} is not a function.`)}function gn(e){return typeof e=="object"&&e!==null||typeof e=="function"}function pr(e,a){if(!gn(e))throw new TypeError(`${a} is not an object.`)}function je(e,a,i){if(e===void 0)throw new TypeError(`Parameter ${a} is required in '${i}'.`)}function Dt(e,a,i){if(e===void 0)throw new TypeError(`${a} is required in '${i}'.`)}function Sn(e){return Number(e)}function Ea(e){return e===0?0:e}function Ei(e){return Ea(bn(e))}function Ra(e,a){let u=Number.MAX_SAFE_INTEGER,p=Number(e);if(p=Ea(p),!pe(p))throw new TypeError(`${a} is not a finite number`);if(p=Ei(p),p<0||p>u)throw new TypeError(`${a} is outside the accepted range of 0 to ${u}, inclusive`);return!pe(p)||p===0?0:p}function wn(e,a){if(!Ze(e))throw new TypeError(`${a} is not a ReadableStream.`)}function yt(e){return new Lt(e)}function xa(e,a){e._reader._readRequests.push(a)}function _n(e,a,i){let p=e._reader._readRequests.shift();i?p._closeSteps():p._chunkSteps(a)}function mr(e){return e._reader._readRequests.length}function $a(e){let a=e._reader;return!(a===void 0||!He(a))}class Lt{constructor(a){if(je(a,1,"ReadableStreamDefaultReader"),wn(a,"First parameter"),Xe(a))throw new TypeError("This stream has already been locked for exclusive reading by another reader");nt(this,a),this._readRequests=new ee}get closed(){return He(this)?this._closedPromise:E(hr("closed"))}cancel(a=void 0){return He(this)?this._ownerReadableStream===void 0?E(J("cancel")):Te(this,a):E(hr("cancel"))}read(){if(!He(this))return E(hr("read"));if(this._ownerReadableStream===void 0)return E(J("read from"));let a,i,u=k((g,w)=>{a=g,i=w});return Bt(this,{_chunkSteps:g=>a({value:g,done:!1}),_closeSteps:()=>a({value:void 0,done:!0}),_errorSteps:g=>i(g)}),u}releaseLock(){if(!He(this))throw hr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Y(this)}}}Object.defineProperties(Lt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Lt.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function He(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Lt}function Bt(e,a){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="closed"?a._closeSteps():i._state==="errored"?a._errorSteps(i._storedError):i._readableStreamController[le](a)}function hr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Pa=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Ta{constructor(a,i){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=a,this._preventCancel=i}next(){let a=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?z(this._ongoingPromise,a,a):a(),this._ongoingPromise}return(a){let i=()=>this._returnSteps(a);return this._ongoingPromise?z(this._ongoingPromise,i,i):i()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let a=this._reader;if(a._ownerReadableStream===void 0)return E(J("iterate"));let i,u,p=k((w,x)=>{i=w,u=x});return Bt(a,{_chunkSteps:w=>{this._ongoingPromise=void 0,$(()=>i({value:w,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Y(a),i({value:void 0,done:!0})},_errorSteps:w=>{this._ongoingPromise=void 0,this._isFinished=!0,Y(a),u(w)}}),p}_returnSteps(a){if(this._isFinished)return Promise.resolve({value:a,done:!0});this._isFinished=!0;let i=this._reader;if(i._ownerReadableStream===void 0)return E(J("finish iterating"));if(!this._preventCancel){let u=Te(i,a);return Y(i),z(u,()=>({value:a,done:!0}))}return Y(i),_({value:a,done:!0})}}let va={next(){return ja(this)?this._asyncIteratorImpl.next():E(Ca("next"))},return(e){return ja(this)?this._asyncIteratorImpl.return(e):E(Ca("return"))}};Pa!==void 0&&Object.setPrototypeOf(va,Pa);function Ri(e,a){let i=yt(e),u=new Ta(i,a),p=Object.create(va);return p._asyncIteratorImpl=u,p}function ja(e){if(!c(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Ta}catch{return!1}}function Ca(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let Aa=Number.isNaN||function(e){return e!==e};function zt(e){return e.slice()}function Ia(e,a,i,u,p){new Uint8Array(e).set(new Uint8Array(i,u,p),a)}function zd(e){return e}function br(e){return!1}function Ma(e,a,i){if(e.slice)return e.slice(a,i);let u=i-a,p=new ArrayBuffer(u);return Ia(p,0,e,a,u),p}function xi(e){return!(typeof e!="number"||Aa(e)||e<0)}function Ua(e){let a=Ma(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(a)}function On(e){let a=e._queue.shift();return e._queueTotalSize-=a.size,e._queueTotalSize<0&&(e._queueTotalSize=0),a.value}function kn(e,a,i){if(!xi(i)||i===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:a,size:i}),e._queueTotalSize+=i}function $i(e){return e._queue.peek().value}function Ge(e){e._queue=new ee,e._queueTotalSize=0}class Wt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!En(this))throw Pn("view");return this._view}respond(a){if(!En(this))throw Pn("respond");if(je(a,1,"respond"),a=Ra(a,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");br(this._view.buffer),_r(this._associatedReadableByteStreamController,a)}respondWithNewView(a){if(!En(this))throw Pn("respondWithNewView");if(je(a,1,"respondWithNewView"),!ArrayBuffer.isView(a))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");br(a.buffer),Or(this._associatedReadableByteStreamController,a)}}Object.defineProperties(Wt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Wt.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class gt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!at(this))throw Nt("byobRequest");return $n(this)}get desiredSize(){if(!at(this))throw Nt("desiredSize");return Na(this)}close(){if(!at(this))throw Nt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let a=this._controlledReadableByteStream._state;if(a!=="readable")throw new TypeError(`The stream (in ${a} state) is not in the readable state and cannot be closed`);Ft(this)}enqueue(a){if(!at(this))throw Nt("enqueue");if(je(a,1,"enqueue"),!ArrayBuffer.isView(a))throw new TypeError("chunk must be an array buffer view");if(a.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(a.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be enqueued to`);wr(this,a)}error(a=void 0){if(!at(this))throw Nt("error");Ce(this,a)}[Je](a){qa(this),Ge(this);let i=this._cancelAlgorithm(a);return Sr(this),i}[le](a){let i=this._controlledReadableByteStream;if(this._queueTotalSize>0){let p=this._queue.shift();this._queueTotalSize-=p.byteLength,za(this);let g=new Uint8Array(p.buffer,p.byteOffset,p.byteLength);a._chunkSteps(g);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let p;try{p=new ArrayBuffer(u)}catch(w){a._errorSteps(w);return}let g={buffer:p,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(g)}xa(i,a),st(this)}}Object.defineProperties(gt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(gt.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function at(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof gt}function En(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Wt}function st(e){if(!ji(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();R(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,st(e))},u=>{Ce(e,u)})}function qa(e){xn(e),e._pendingPullIntos=new ee}function Rn(e,a){let i=!1;e._state==="closed"&&(i=!0);let u=Da(a);a.readerType==="default"?_n(e,u,i):Ii(e,u,i)}function Da(e){let a=e.bytesFilled,i=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,a/i)}function yr(e,a,i,u){e._queue.push({buffer:a,byteOffset:i,byteLength:u}),e._queueTotalSize+=u}function La(e,a){let i=a.elementSize,u=a.bytesFilled-a.bytesFilled%i,p=Math.min(e._queueTotalSize,a.byteLength-a.bytesFilled),g=a.bytesFilled+p,w=g-g%i,x=p,M=!1;w>u&&(x=w-a.bytesFilled,M=!0);let B=e._queue;for(;x>0;){let N=B.peek(),Q=Math.min(x,N.byteLength),Z=a.byteOffset+a.bytesFilled;Ia(a.buffer,Z,N.buffer,N.byteOffset,Q),N.byteLength===Q?B.shift():(N.byteOffset+=Q,N.byteLength-=Q),e._queueTotalSize-=Q,Ba(e,Q,a),x-=Q}return M}function Ba(e,a,i){i.bytesFilled+=a}function za(e){e._queueTotalSize===0&&e._closeRequested?(Sr(e),Zt(e._controlledReadableByteStream)):st(e)}function xn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Wa(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let a=e._pendingPullIntos.peek();La(e,a)&&(gr(e),Rn(e._controlledReadableByteStream,a))}}function Pi(e,a,i){let u=e._controlledReadableByteStream,p=1;a.constructor!==DataView&&(p=a.constructor.BYTES_PER_ELEMENT);let g=a.constructor,w=a.buffer,x={buffer:w,bufferByteLength:w.byteLength,byteOffset:a.byteOffset,byteLength:a.byteLength,bytesFilled:0,elementSize:p,viewConstructor:g,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(x),Ja(u,i);return}if(u._state==="closed"){let M=new g(x.buffer,x.byteOffset,0);i._closeSteps(M);return}if(e._queueTotalSize>0){if(La(e,x)){let M=Da(x);za(e),i._chunkSteps(M);return}if(e._closeRequested){let M=new TypeError("Insufficient bytes to fill elements in the given buffer");Ce(e,M),i._errorSteps(M);return}}e._pendingPullIntos.push(x),Ja(u,i),st(e)}function Ti(e,a){let i=e._controlledReadableByteStream;if(Tn(i))for(;Ha(i)>0;){let u=gr(e);Rn(i,u)}}function vi(e,a,i){if(Ba(e,a,i),i.bytesFilled<i.elementSize)return;gr(e);let u=i.bytesFilled%i.elementSize;if(u>0){let p=i.byteOffset+i.bytesFilled,g=Ma(i.buffer,p-u,p);yr(e,g,0,g.byteLength)}i.bytesFilled-=u,Rn(e._controlledReadableByteStream,i),Wa(e)}function Fa(e,a){let i=e._pendingPullIntos.peek();xn(e),e._controlledReadableByteStream._state==="closed"?Ti(e):vi(e,a,i),st(e)}function gr(e){return e._pendingPullIntos.shift()}function ji(e){let a=e._controlledReadableByteStream;return a._state!=="readable"||e._closeRequested||!e._started?!1:!!($a(a)&&mr(a)>0||Tn(a)&&Ha(a)>0||Na(e)>0)}function Sr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ft(e){let a=e._controlledReadableByteStream;if(!(e._closeRequested||a._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Ce(e,u),u}Sr(e),Zt(a)}}function wr(e,a){let i=e._controlledReadableByteStream;if(e._closeRequested||i._state!=="readable")return;let u=a.buffer,p=a.byteOffset,g=a.byteLength,w=u;if(e._pendingPullIntos.length>0){let x=e._pendingPullIntos.peek();br(x.buffer),x.buffer=x.buffer}if(xn(e),$a(i))if(mr(i)===0)yr(e,w,p,g);else{e._pendingPullIntos.length>0&&gr(e);let x=new Uint8Array(w,p,g);_n(i,x,!1)}else Tn(i)?(yr(e,w,p,g),Wa(e)):yr(e,w,p,g);st(e)}function Ce(e,a){let i=e._controlledReadableByteStream;i._state==="readable"&&(qa(e),Ge(e),Sr(e),gs(i,a))}function $n(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let a=e._pendingPullIntos.peek(),i=new Uint8Array(a.buffer,a.byteOffset+a.bytesFilled,a.byteLength-a.bytesFilled),u=Object.create(Wt.prototype);Ai(u,e,i),e._byobRequest=u}return e._byobRequest}function Na(e){let a=e._controlledReadableByteStream._state;return a==="errored"?null:a==="closed"?0:e._strategyHWM-e._queueTotalSize}function _r(e,a){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(a!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(a===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(i.bytesFilled+a>i.byteLength)throw new RangeError("bytesWritten out of range")}i.buffer=i.buffer,Fa(e,a)}function Or(e,a){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(a.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(a.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(i.byteOffset+i.bytesFilled!==a.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.bufferByteLength!==a.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(i.bytesFilled+a.byteLength>i.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let p=a.byteLength;i.buffer=a.buffer,Fa(e,p)}function Qa(e,a,i,u,p,g,w){a._controlledReadableByteStream=e,a._pullAgain=!1,a._pulling=!1,a._byobRequest=null,a._queue=a._queueTotalSize=void 0,Ge(a),a._closeRequested=!1,a._started=!1,a._strategyHWM=g,a._pullAlgorithm=u,a._cancelAlgorithm=p,a._autoAllocateChunkSize=w,a._pendingPullIntos=new ee,e._readableStreamController=a;let x=i();R(_(x),()=>{a._started=!0,st(a)},M=>{Ce(a,M)})}function Ci(e,a,i){let u=Object.create(gt.prototype),p=()=>{},g=()=>_(void 0),w=()=>_(void 0);a.start!==void 0&&(p=()=>a.start(u)),a.pull!==void 0&&(g=()=>a.pull(u)),a.cancel!==void 0&&(w=M=>a.cancel(M));let x=a.autoAllocateChunkSize;if(x===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Qa(e,u,p,g,w,i,x)}function Ai(e,a,i){e._associatedReadableByteStreamController=a,e._view=i}function Pn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Nt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Va(e){return new Qt(e)}function Ja(e,a){e._reader._readIntoRequests.push(a)}function Ii(e,a,i){let p=e._reader._readIntoRequests.shift();i?p._closeSteps(a):p._chunkSteps(a)}function Ha(e){return e._reader._readIntoRequests.length}function Tn(e){let a=e._reader;return!(a===void 0||!ot(a))}class Qt{constructor(a){if(je(a,1,"ReadableStreamBYOBReader"),wn(a,"First parameter"),Xe(a))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!at(a._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");nt(this,a),this._readIntoRequests=new ee}get closed(){return ot(this)?this._closedPromise:E(kr("closed"))}cancel(a=void 0){return ot(this)?this._ownerReadableStream===void 0?E(J("cancel")):Te(this,a):E(kr("cancel"))}read(a){if(!ot(this))return E(kr("read"));if(!ArrayBuffer.isView(a))return E(new TypeError("view must be an array buffer view"));if(a.byteLength===0)return E(new TypeError("view must have non-zero byteLength"));if(a.buffer.byteLength===0)return E(new TypeError("view's buffer must have non-zero byteLength"));if(br(a.buffer),this._ownerReadableStream===void 0)return E(J("read from"));let i,u,p=k((w,x)=>{i=w,u=x});return Ga(this,a,{_chunkSteps:w=>i({value:w,done:!1}),_closeSteps:w=>i({value:w,done:!0}),_errorSteps:w=>u(w)}),p}releaseLock(){if(!ot(this))throw kr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Y(this)}}}Object.defineProperties(Qt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Qt.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function ot(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Qt}function Ga(e,a,i){let u=e._ownerReadableStream;u._disturbed=!0,u._state==="errored"?i._errorSteps(u._storedError):Pi(u._readableStreamController,a,i)}function kr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Vt(e,a){let{highWaterMark:i}=e;if(i===void 0)return a;if(Aa(i)||i<0)throw new RangeError("Invalid highWaterMark");return i}function Er(e){let{size:a}=e;return a||(()=>1)}function Rr(e,a){ve(e,a);let i=e?.highWaterMark,u=e?.size;return{highWaterMark:i===void 0?void 0:Sn(i),size:u===void 0?void 0:Mi(u,`${a} has member 'size' that`)}}function Mi(e,a){return ge(e,a),i=>Sn(e(i))}function Ui(e,a){ve(e,a);let i=e?.abort,u=e?.close,p=e?.start,g=e?.type,w=e?.write;return{abort:i===void 0?void 0:qi(i,e,`${a} has member 'abort' that`),close:u===void 0?void 0:Di(u,e,`${a} has member 'close' that`),start:p===void 0?void 0:Li(p,e,`${a} has member 'start' that`),write:w===void 0?void 0:Bi(w,e,`${a} has member 'write' that`),type:g}}function qi(e,a,i){return ge(e,i),u=>I(e,a,[u])}function Di(e,a,i){return ge(e,i),()=>I(e,a,[])}function Li(e,a,i){return ge(e,i),u=>L(e,a,[u])}function Bi(e,a,i){return ge(e,i),(u,p)=>I(e,a,[u,p])}function Ya(e,a){if(!St(e))throw new TypeError(`${a} is not a WritableStream.`)}function zi(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Wi=typeof AbortController=="function";function Fi(){if(Wi)return new AbortController}class Jt{constructor(a={},i={}){a===void 0?a=null:pr(a,"First parameter");let u=Rr(i,"Second parameter"),p=Ui(a,"First parameter");if(Za(this),p.type!==void 0)throw new RangeError("Invalid type is specified");let w=Er(u),x=Vt(u,1);nc(this,p,x,w)}get locked(){if(!St(this))throw vr("locked");return wt(this)}abort(a=void 0){return St(this)?wt(this)?E(new TypeError("Cannot abort a stream that already has a writer")):xr(this,a):E(vr("abort"))}close(){return St(this)?wt(this)?E(new TypeError("Cannot close a stream that already has a writer")):De(this)?E(new TypeError("Cannot close an already-closing stream")):Xa(this):E(vr("close"))}getWriter(){if(!St(this))throw vr("getWriter");return Ka(this)}}Object.defineProperties(Jt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Jt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function Ka(e){return new Ht(e)}function Ni(e,a,i,u,p=1,g=()=>1){let w=Object.create(Jt.prototype);Za(w);let x=Object.create(_t.prototype);return ss(w,x,e,a,i,u,p,g),w}function Za(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new ee,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function St(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Jt}function wt(e){return e._writer!==void 0}function xr(e,a){var i;if(e._state==="closed"||e._state==="errored")return _(void 0);e._writableStreamController._abortReason=a,(i=e._writableStreamController._abortController)===null||i===void 0||i.abort();let u=e._state;if(u==="closed"||u==="errored")return _(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let p=!1;u==="erroring"&&(p=!0,a=void 0);let g=k((w,x)=>{e._pendingAbortRequest={_promise:void 0,_resolve:w,_reject:x,_reason:a,_wasAlreadyErroring:p}});return e._pendingAbortRequest._promise=g,p||jn(e,a),g}function Xa(e){let a=e._state;if(a==="closed"||a==="errored")return E(new TypeError(`The stream (in ${a} state) is not in the writable state and cannot be closed`));let i=k((p,g)=>{let w={_resolve:p,_reject:g};e._closeRequest=w}),u=e._writer;return u!==void 0&&e._backpressure&&a==="writable"&&Bn(u),ac(e._writableStreamController),i}function Qi(e){return k((i,u)=>{let p={_resolve:i,_reject:u};e._writeRequests.push(p)})}function vn(e,a){if(e._state==="writable"){jn(e,a);return}Cn(e)}function jn(e,a){let i=e._writableStreamController;e._state="erroring",e._storedError=a;let u=e._writer;u!==void 0&&ts(u,a),!Yi(e)&&i._started&&Cn(e)}function Cn(e){e._state="errored",e._writableStreamController[qe]();let a=e._storedError;if(e._writeRequests.forEach(p=>{p._reject(a)}),e._writeRequests=new ee,e._pendingAbortRequest===void 0){$r(e);return}let i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring){i._reject(a),$r(e);return}let u=e._writableStreamController[te](i._reason);R(u,()=>{i._resolve(),$r(e)},p=>{i._reject(p),$r(e)})}function Vi(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Ji(e,a){e._inFlightWriteRequest._reject(a),e._inFlightWriteRequest=void 0,vn(e,a)}function Hi(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let i=e._writer;i!==void 0&&us(i)}function Gi(e,a){e._inFlightCloseRequest._reject(a),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(a),e._pendingAbortRequest=void 0),vn(e,a)}function De(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Yi(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ki(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Zi(e){e._inFlightWriteRequest=e._writeRequests.shift()}function $r(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let a=e._writer;a!==void 0&&Dn(a,e._storedError)}function An(e,a){let i=e._writer;i!==void 0&&a!==e._backpressure&&(a?dc(i):Bn(i)),e._backpressure=a}class Ht{constructor(a){if(je(a,1,"WritableStreamDefaultWriter"),Ya(a,"First parameter"),wt(a))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=a,a._writer=this;let i=a._state;if(i==="writable")!De(a)&&a._backpressure?Cr(this):ls(this),jr(this);else if(i==="erroring")Ln(this,a._storedError),jr(this);else if(i==="closed")ls(this),uc(this);else{let u=a._storedError;Ln(this,u),cs(this,u)}}get closed(){return it(this)?this._closedPromise:E(ct("closed"))}get desiredSize(){if(!it(this))throw ct("desiredSize");if(this._ownerWritableStream===void 0)throw Gt("desiredSize");return rc(this)}get ready(){return it(this)?this._readyPromise:E(ct("ready"))}abort(a=void 0){return it(this)?this._ownerWritableStream===void 0?E(Gt("abort")):Xi(this,a):E(ct("abort"))}close(){if(!it(this))return E(ct("close"));let a=this._ownerWritableStream;return a===void 0?E(Gt("close")):De(a)?E(new TypeError("Cannot close an already-closing stream")):es(this)}releaseLock(){if(!it(this))throw ct("releaseLock");this._ownerWritableStream!==void 0&&rs(this)}write(a=void 0){return it(this)?this._ownerWritableStream===void 0?E(Gt("write to")):ns(this,a):E(ct("write"))}}Object.defineProperties(Ht.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ht.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function it(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Ht}function Xi(e,a){let i=e._ownerWritableStream;return xr(i,a)}function es(e){let a=e._ownerWritableStream;return Xa(a)}function ec(e){let a=e._ownerWritableStream,i=a._state;return De(a)||i==="closed"?_(void 0):i==="errored"?E(a._storedError):es(e)}function tc(e,a){e._closedPromiseState==="pending"?Dn(e,a):lc(e,a)}function ts(e,a){e._readyPromiseState==="pending"?ds(e,a):fc(e,a)}function rc(e){let a=e._ownerWritableStream,i=a._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:os(a._writableStreamController)}function rs(e){let a=e._ownerWritableStream,i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");ts(e,i),tc(e,i),a._writer=void 0,e._ownerWritableStream=void 0}function ns(e,a){let i=e._ownerWritableStream,u=i._writableStreamController,p=sc(u,a);if(i!==e._ownerWritableStream)return E(Gt("write to"));let g=i._state;if(g==="errored")return E(i._storedError);if(De(i)||g==="closed")return E(new TypeError("The stream is closing or closed and cannot be written to"));if(g==="erroring")return E(i._storedError);let w=Qi(i);return oc(u,a,p),w}let as={};class _t{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!In(this))throw qn("abortReason");return this._abortReason}get signal(){if(!In(this))throw qn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(a=void 0){if(!In(this))throw qn("error");this._controlledWritableStream._state==="writable"&&is(this,a)}[te](a){let i=this._abortAlgorithm(a);return Pr(this),i}[qe](){Ge(this)}}Object.defineProperties(_t.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(_t.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function In(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof _t}function ss(e,a,i,u,p,g,w,x){a._controlledWritableStream=e,e._writableStreamController=a,a._queue=void 0,a._queueTotalSize=void 0,Ge(a),a._abortReason=void 0,a._abortController=Fi(),a._started=!1,a._strategySizeAlgorithm=x,a._strategyHWM=w,a._writeAlgorithm=u,a._closeAlgorithm=p,a._abortAlgorithm=g;let M=Un(a);An(e,M);let B=i(),N=_(B);R(N,()=>{a._started=!0,Tr(a)},Q=>{a._started=!0,vn(e,Q)})}function nc(e,a,i,u){let p=Object.create(_t.prototype),g=()=>{},w=()=>_(void 0),x=()=>_(void 0),M=()=>_(void 0);a.start!==void 0&&(g=()=>a.start(p)),a.write!==void 0&&(w=B=>a.write(B,p)),a.close!==void 0&&(x=()=>a.close()),a.abort!==void 0&&(M=B=>a.abort(B)),ss(e,p,g,w,x,M,i,u)}function Pr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function ac(e){kn(e,as,0),Tr(e)}function sc(e,a){try{return e._strategySizeAlgorithm(a)}catch(i){return Mn(e,i),1}}function os(e){return e._strategyHWM-e._queueTotalSize}function oc(e,a,i){try{kn(e,a,i)}catch(p){Mn(e,p);return}let u=e._controlledWritableStream;if(!De(u)&&u._state==="writable"){let p=Un(e);An(u,p)}Tr(e)}function Tr(e){let a=e._controlledWritableStream;if(!e._started||a._inFlightWriteRequest!==void 0)return;if(a._state==="erroring"){Cn(a);return}if(e._queue.length===0)return;let u=$i(e);u===as?ic(e):cc(e,u)}function Mn(e,a){e._controlledWritableStream._state==="writable"&&is(e,a)}function ic(e){let a=e._controlledWritableStream;Ki(a),On(e);let i=e._closeAlgorithm();Pr(e),R(i,()=>{Hi(a)},u=>{Gi(a,u)})}function cc(e,a){let i=e._controlledWritableStream;Zi(i);let u=e._writeAlgorithm(a);R(u,()=>{Vi(i);let p=i._state;if(On(e),!De(i)&&p==="writable"){let g=Un(e);An(i,g)}Tr(e)},p=>{i._state==="writable"&&Pr(e),Ji(i,p)})}function Un(e){return os(e)<=0}function is(e,a){let i=e._controlledWritableStream;Pr(e),jn(i,a)}function vr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function qn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function ct(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Gt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function jr(e){e._closedPromise=k((a,i)=>{e._closedPromise_resolve=a,e._closedPromise_reject=i,e._closedPromiseState="pending"})}function cs(e,a){jr(e),Dn(e,a)}function uc(e){jr(e),us(e)}function Dn(e,a){e._closedPromise_reject!==void 0&&(W(e._closedPromise),e._closedPromise_reject(a),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function lc(e,a){cs(e,a)}function us(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Cr(e){e._readyPromise=k((a,i)=>{e._readyPromise_resolve=a,e._readyPromise_reject=i}),e._readyPromiseState="pending"}function Ln(e,a){Cr(e),ds(e,a)}function ls(e){Cr(e),Bn(e)}function ds(e,a){e._readyPromise_reject!==void 0&&(W(e._readyPromise),e._readyPromise_reject(a),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function dc(e){Cr(e)}function fc(e,a){Ln(e,a)}function Bn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let fs=typeof DOMException<"u"?DOMException:void 0;function pc(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function mc(){let e=function(i,u){this.message=i||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let hc=pc(fs)?fs:mc();function ps(e,a,i,u,p,g){let w=yt(e),x=Ka(a);e._disturbed=!0;let M=!1,B=_(void 0);return k((N,Q)=>{let Z;if(g!==void 0){if(Z=()=>{let T=new hc("Aborted","AbortError"),q=[];u||q.push(()=>a._state==="writable"?xr(a,T):_(void 0)),p||q.push(()=>e._state==="readable"?Ae(e,T):_(void 0)),me(()=>Promise.all(q.map(H=>H())),!0,T)},g.aborted){Z();return}g.addEventListener("abort",Z)}function Ie(){return k((T,q)=>{function H(Se){Se?T():O(Et(),H,q)}H(!1)})}function Et(){return M?_(!0):O(x._readyPromise,()=>k((T,q)=>{Bt(w,{_chunkSteps:H=>{B=O(ns(x,H),void 0,n),T(!1)},_closeSteps:()=>T(!0),_errorSteps:q})}))}if(We(e,w._closedPromise,T=>{u?ke(!0,T):me(()=>xr(a,T),!0,T)}),We(a,x._closedPromise,T=>{p?ke(!0,T):me(()=>Ae(e,T),!0,T)}),de(e,w._closedPromise,()=>{i?ke():me(()=>ec(x))}),De(a)||a._state==="closed"){let T=new TypeError("the destination writable stream closed before all data could be piped to it");p?ke(!0,T):me(()=>Ae(e,T),!0,T)}W(Ie());function et(){let T=B;return O(B,()=>T!==B?et():void 0)}function We(T,q,H){T._state==="errored"?H(T._storedError):j(q,H)}function de(T,q,H){T._state==="closed"?H():P(q,H)}function me(T,q,H){if(M)return;M=!0,a._state==="writable"&&!De(a)?P(et(),Se):Se();function Se(){R(T(),()=>Fe(q,H),Rt=>Fe(!0,Rt))}}function ke(T,q){M||(M=!0,a._state==="writable"&&!De(a)?P(et(),()=>Fe(T,q)):Fe(T,q))}function Fe(T,q){rs(x),Y(w),g!==void 0&&g.removeEventListener("abort",Z),T?Q(q):N(void 0)}})}class Ot{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ar(this))throw Ur("desiredSize");return zn(this)}close(){if(!Ar(this))throw Ur("close");if(!kt(this))throw new TypeError("The stream is not in a state that permits close");Kt(this)}enqueue(a=void 0){if(!Ar(this))throw Ur("enqueue");if(!kt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Mr(this,a)}error(a=void 0){if(!Ar(this))throw Ur("error");Ye(this,a)}[Je](a){Ge(this);let i=this._cancelAlgorithm(a);return Ir(this),i}[le](a){let i=this._controlledReadableStream;if(this._queue.length>0){let u=On(this);this._closeRequested&&this._queue.length===0?(Ir(this),Zt(i)):Yt(this),a._chunkSteps(u)}else xa(i,a),Yt(this)}}Object.defineProperties(Ot.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ot.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Ar(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Ot}function Yt(e){if(!ms(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();R(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Yt(e))},u=>{Ye(e,u)})}function ms(e){let a=e._controlledReadableStream;return!kt(e)||!e._started?!1:!!(Xe(a)&&mr(a)>0||zn(e)>0)}function Ir(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Kt(e){if(!kt(e))return;let a=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Ir(e),Zt(a))}function Mr(e,a){if(!kt(e))return;let i=e._controlledReadableStream;if(Xe(i)&&mr(i)>0)_n(i,a,!1);else{let u;try{u=e._strategySizeAlgorithm(a)}catch(p){throw Ye(e,p),p}try{kn(e,a,u)}catch(p){throw Ye(e,p),p}}Yt(e)}function Ye(e,a){let i=e._controlledReadableStream;i._state==="readable"&&(Ge(e),Ir(e),gs(i,a))}function zn(e){let a=e._controlledReadableStream._state;return a==="errored"?null:a==="closed"?0:e._strategyHWM-e._queueTotalSize}function bc(e){return!ms(e)}function kt(e){let a=e._controlledReadableStream._state;return!e._closeRequested&&a==="readable"}function hs(e,a,i,u,p,g,w){a._controlledReadableStream=e,a._queue=void 0,a._queueTotalSize=void 0,Ge(a),a._started=!1,a._closeRequested=!1,a._pullAgain=!1,a._pulling=!1,a._strategySizeAlgorithm=w,a._strategyHWM=g,a._pullAlgorithm=u,a._cancelAlgorithm=p,e._readableStreamController=a;let x=i();R(_(x),()=>{a._started=!0,Yt(a)},M=>{Ye(a,M)})}function yc(e,a,i,u){let p=Object.create(Ot.prototype),g=()=>{},w=()=>_(void 0),x=()=>_(void 0);a.start!==void 0&&(g=()=>a.start(p)),a.pull!==void 0&&(w=()=>a.pull(p)),a.cancel!==void 0&&(x=M=>a.cancel(M)),hs(e,p,g,w,x,i,u)}function Ur(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function gc(e,a){return at(e._readableStreamController)?wc(e):Sc(e)}function Sc(e,a){let i=yt(e),u=!1,p=!1,g=!1,w=!1,x,M,B,N,Q,Z=k(de=>{Q=de});function Ie(){return u?(p=!0,_(void 0)):(u=!0,Bt(i,{_chunkSteps:me=>{$(()=>{p=!1;let ke=me,Fe=me;g||Mr(B._readableStreamController,ke),w||Mr(N._readableStreamController,Fe),u=!1,p&&Ie()})},_closeSteps:()=>{u=!1,g||Kt(B._readableStreamController),w||Kt(N._readableStreamController),(!g||!w)&&Q(void 0)},_errorSteps:()=>{u=!1}}),_(void 0))}function Et(de){if(g=!0,x=de,w){let me=zt([x,M]),ke=Ae(e,me);Q(ke)}return Z}function et(de){if(w=!0,M=de,g){let me=zt([x,M]),ke=Ae(e,me);Q(ke)}return Z}function We(){}return B=Wn(We,Ie,Et),N=Wn(We,Ie,et),j(i._closedPromise,de=>{Ye(B._readableStreamController,de),Ye(N._readableStreamController,de),(!g||!w)&&Q(void 0)}),[B,N]}function wc(e){let a=yt(e),i=!1,u=!1,p=!1,g=!1,w=!1,x,M,B,N,Q,Z=k(T=>{Q=T});function Ie(T){j(T._closedPromise,q=>{T===a&&(Ce(B._readableStreamController,q),Ce(N._readableStreamController,q),(!g||!w)&&Q(void 0))})}function Et(){ot(a)&&(Y(a),a=yt(e),Ie(a)),Bt(a,{_chunkSteps:q=>{$(()=>{u=!1,p=!1;let H=q,Se=q;if(!g&&!w)try{Se=Ua(q)}catch(Rt){Ce(B._readableStreamController,Rt),Ce(N._readableStreamController,Rt),Q(Ae(e,Rt));return}g||wr(B._readableStreamController,H),w||wr(N._readableStreamController,Se),i=!1,u?We():p&&de()})},_closeSteps:()=>{i=!1,g||Ft(B._readableStreamController),w||Ft(N._readableStreamController),B._readableStreamController._pendingPullIntos.length>0&&_r(B._readableStreamController,0),N._readableStreamController._pendingPullIntos.length>0&&_r(N._readableStreamController,0),(!g||!w)&&Q(void 0)},_errorSteps:()=>{i=!1}})}function et(T,q){He(a)&&(Y(a),a=Va(e),Ie(a));let H=q?N:B,Se=q?B:N;Ga(a,T,{_chunkSteps:xt=>{$(()=>{u=!1,p=!1;let $t=q?w:g;if(q?g:w)$t||Or(H._readableStreamController,xt);else{let js;try{js=Ua(xt)}catch(Nn){Ce(H._readableStreamController,Nn),Ce(Se._readableStreamController,Nn),Q(Ae(e,Nn));return}$t||Or(H._readableStreamController,xt),wr(Se._readableStreamController,js)}i=!1,u?We():p&&de()})},_closeSteps:xt=>{i=!1;let $t=q?w:g,Qr=q?g:w;$t||Ft(H._readableStreamController),Qr||Ft(Se._readableStreamController),xt!==void 0&&($t||Or(H._readableStreamController,xt),!Qr&&Se._readableStreamController._pendingPullIntos.length>0&&_r(Se._readableStreamController,0)),(!$t||!Qr)&&Q(void 0)},_errorSteps:()=>{i=!1}})}function We(){if(i)return u=!0,_(void 0);i=!0;let T=$n(B._readableStreamController);return T===null?Et():et(T._view,!1),_(void 0)}function de(){if(i)return p=!0,_(void 0);i=!0;let T=$n(N._readableStreamController);return T===null?Et():et(T._view,!0),_(void 0)}function me(T){if(g=!0,x=T,w){let q=zt([x,M]),H=Ae(e,q);Q(H)}return Z}function ke(T){if(w=!0,M=T,g){let q=zt([x,M]),H=Ae(e,q);Q(H)}return Z}function Fe(){}return B=ys(Fe,We,me),N=ys(Fe,de,ke),Ie(a),[B,N]}function _c(e,a){ve(e,a);let i=e,u=i?.autoAllocateChunkSize,p=i?.cancel,g=i?.pull,w=i?.start,x=i?.type;return{autoAllocateChunkSize:u===void 0?void 0:Ra(u,`${a} has member 'autoAllocateChunkSize' that`),cancel:p===void 0?void 0:Oc(p,i,`${a} has member 'cancel' that`),pull:g===void 0?void 0:kc(g,i,`${a} has member 'pull' that`),start:w===void 0?void 0:Ec(w,i,`${a} has member 'start' that`),type:x===void 0?void 0:Rc(x,`${a} has member 'type' that`)}}function Oc(e,a,i){return ge(e,i),u=>I(e,a,[u])}function kc(e,a,i){return ge(e,i),u=>I(e,a,[u])}function Ec(e,a,i){return ge(e,i),u=>L(e,a,[u])}function Rc(e,a){if(e=`${e}`,e!=="bytes")throw new TypeError(`${a} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function xc(e,a){ve(e,a);let i=e?.mode;return{mode:i===void 0?void 0:$c(i,`${a} has member 'mode' that`)}}function $c(e,a){if(e=`${e}`,e!=="byob")throw new TypeError(`${a} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Pc(e,a){return ve(e,a),{preventCancel:!!e?.preventCancel}}function bs(e,a){ve(e,a);let i=e?.preventAbort,u=e?.preventCancel,p=e?.preventClose,g=e?.signal;return g!==void 0&&Tc(g,`${a} has member 'signal' that`),{preventAbort:!!i,preventCancel:!!u,preventClose:!!p,signal:g}}function Tc(e,a){if(!zi(e))throw new TypeError(`${a} is not an AbortSignal.`)}function vc(e,a){ve(e,a);let i=e?.readable;Dt(i,"readable","ReadableWritablePair"),wn(i,`${a} has member 'readable' that`);let u=e?.writable;return Dt(u,"writable","ReadableWritablePair"),Ya(u,`${a} has member 'writable' that`),{readable:i,writable:u}}class Ke{constructor(a={},i={}){a===void 0?a=null:pr(a,"First parameter");let u=Rr(i,"Second parameter"),p=_c(a,"First parameter");if(Fn(this),p.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let g=Vt(u,0);Ci(this,p,g)}else{let g=Er(u),w=Vt(u,1);yc(this,p,w,g)}}get locked(){if(!Ze(this))throw ut("locked");return Xe(this)}cancel(a=void 0){return Ze(this)?Xe(this)?E(new TypeError("Cannot cancel a stream that already has a reader")):Ae(this,a):E(ut("cancel"))}getReader(a=void 0){if(!Ze(this))throw ut("getReader");return xc(a,"First parameter").mode===void 0?yt(this):Va(this)}pipeThrough(a,i={}){if(!Ze(this))throw ut("pipeThrough");je(a,1,"pipeThrough");let u=vc(a,"First parameter"),p=bs(i,"Second parameter");if(Xe(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(wt(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let g=ps(this,u.writable,p.preventClose,p.preventAbort,p.preventCancel,p.signal);return W(g),u.readable}pipeTo(a,i={}){if(!Ze(this))return E(ut("pipeTo"));if(a===void 0)return E("Parameter 1 is required in 'pipeTo'.");if(!St(a))return E(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=bs(i,"Second parameter")}catch(p){return E(p)}return Xe(this)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):wt(a)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ps(this,a,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!Ze(this))throw ut("tee");let a=gc(this);return zt(a)}values(a=void 0){if(!Ze(this))throw ut("values");let i=Pc(a,"First parameter");return Ri(this,i.preventCancel)}}Object.defineProperties(Ke.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ke.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(Ke.prototype,t.asyncIterator,{value:Ke.prototype.values,writable:!0,configurable:!0});function Wn(e,a,i,u=1,p=()=>1){let g=Object.create(Ke.prototype);Fn(g);let w=Object.create(Ot.prototype);return hs(g,w,e,a,i,u,p),g}function ys(e,a,i){let u=Object.create(Ke.prototype);Fn(u);let p=Object.create(gt.prototype);return Qa(u,p,e,a,i,0,void 0),u}function Fn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Ze(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof Ke}function Xe(e){return e._reader!==void 0}function Ae(e,a){if(e._disturbed=!0,e._state==="closed")return _(void 0);if(e._state==="errored")return E(e._storedError);Zt(e);let i=e._reader;i!==void 0&&ot(i)&&(i._readIntoRequests.forEach(p=>{p._closeSteps(void 0)}),i._readIntoRequests=new ee);let u=e._readableStreamController[Je](a);return z(u,n)}function Zt(e){e._state="closed";let a=e._reader;a!==void 0&&(K(a),He(a)&&(a._readRequests.forEach(i=>{i._closeSteps()}),a._readRequests=new ee))}function gs(e,a){e._state="errored",e._storedError=a;let i=e._reader;i!==void 0&&(se(i,a),He(i)?(i._readRequests.forEach(u=>{u._errorSteps(a)}),i._readRequests=new ee):(i._readIntoRequests.forEach(u=>{u._errorSteps(a)}),i._readIntoRequests=new ee))}function ut(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Ss(e,a){ve(e,a);let i=e?.highWaterMark;return Dt(i,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Sn(i)}}let ws=e=>e.byteLength;try{Object.defineProperty(ws,"name",{value:"size",configurable:!0})}catch{}class qr{constructor(a){je(a,1,"ByteLengthQueuingStrategy"),a=Ss(a,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=a.highWaterMark}get highWaterMark(){if(!Os(this))throw _s("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Os(this))throw _s("size");return ws}}Object.defineProperties(qr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(qr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function _s(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Os(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof qr}let ks=()=>1;try{Object.defineProperty(ks,"name",{value:"size",configurable:!0})}catch{}class Dr{constructor(a){je(a,1,"CountQueuingStrategy"),a=Ss(a,"First parameter"),this._countQueuingStrategyHighWaterMark=a.highWaterMark}get highWaterMark(){if(!Rs(this))throw Es("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Rs(this))throw Es("size");return ks}}Object.defineProperties(Dr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Dr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Es(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Rs(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Dr}function jc(e,a){ve(e,a);let i=e?.flush,u=e?.readableType,p=e?.start,g=e?.transform,w=e?.writableType;return{flush:i===void 0?void 0:Cc(i,e,`${a} has member 'flush' that`),readableType:u,start:p===void 0?void 0:Ac(p,e,`${a} has member 'start' that`),transform:g===void 0?void 0:Ic(g,e,`${a} has member 'transform' that`),writableType:w}}function Cc(e,a,i){return ge(e,i),u=>I(e,a,[u])}function Ac(e,a,i){return ge(e,i),u=>L(e,a,[u])}function Ic(e,a,i){return ge(e,i),(u,p)=>I(e,a,[u,p])}class Lr{constructor(a={},i={},u={}){a===void 0&&(a=null);let p=Rr(i,"Second parameter"),g=Rr(u,"Third parameter"),w=jc(a,"First parameter");if(w.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(w.writableType!==void 0)throw new RangeError("Invalid writableType specified");let x=Vt(g,0),M=Er(g),B=Vt(p,1),N=Er(p),Q,Z=k(Ie=>{Q=Ie});Mc(this,Z,B,N,x,M),qc(this,w),w.start!==void 0?Q(w.start(this._transformStreamController)):Q(void 0)}get readable(){if(!xs(this))throw vs("readable");return this._readable}get writable(){if(!xs(this))throw vs("writable");return this._writable}}Object.defineProperties(Lr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Lr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Mc(e,a,i,u,p,g){function w(){return a}function x(Z){return Bc(e,Z)}function M(Z){return zc(e,Z)}function B(){return Wc(e)}e._writable=Ni(w,x,B,M,i,u);function N(){return Fc(e)}function Q(Z){return zr(e,Z),_(void 0)}e._readable=Wn(w,N,Q,p,g),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Wr(e,!0),e._transformStreamController=void 0}function xs(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Lr}function Br(e,a){Ye(e._readable._readableStreamController,a),zr(e,a)}function zr(e,a){$s(e._transformStreamController),Mn(e._writable._writableStreamController,a),e._backpressure&&Wr(e,!1)}function Wr(e,a){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=k(i=>{e._backpressureChangePromise_resolve=i}),e._backpressure=a}class Xt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Fr(this))throw Nr("desiredSize");let a=this._controlledTransformStream._readable._readableStreamController;return zn(a)}enqueue(a=void 0){if(!Fr(this))throw Nr("enqueue");Ps(this,a)}error(a=void 0){if(!Fr(this))throw Nr("error");Dc(this,a)}terminate(){if(!Fr(this))throw Nr("terminate");Lc(this)}}Object.defineProperties(Xt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Xt.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Fr(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Xt}function Uc(e,a,i,u){a._controlledTransformStream=e,e._transformStreamController=a,a._transformAlgorithm=i,a._flushAlgorithm=u}function qc(e,a){let i=Object.create(Xt.prototype),u=g=>{try{return Ps(i,g),_(void 0)}catch(w){return E(w)}},p=()=>_(void 0);a.transform!==void 0&&(u=g=>a.transform(g,i)),a.flush!==void 0&&(p=()=>a.flush(i)),Uc(e,i,u,p)}function $s(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Ps(e,a){let i=e._controlledTransformStream,u=i._readable._readableStreamController;if(!kt(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{Mr(u,a)}catch(g){throw zr(i,g),i._readable._storedError}bc(u)!==i._backpressure&&Wr(i,!0)}function Dc(e,a){Br(e._controlledTransformStream,a)}function Ts(e,a){let i=e._transformAlgorithm(a);return z(i,void 0,u=>{throw Br(e._controlledTransformStream,u),u})}function Lc(e){let a=e._controlledTransformStream,i=a._readable._readableStreamController;Kt(i);let u=new TypeError("TransformStream terminated");zr(a,u)}function Bc(e,a){let i=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return z(u,()=>{let p=e._writable;if(p._state==="erroring")throw p._storedError;return Ts(i,a)})}return Ts(i,a)}function zc(e,a){return Br(e,a),_(void 0)}function Wc(e){let a=e._readable,i=e._transformStreamController,u=i._flushAlgorithm();return $s(i),z(u,()=>{if(a._state==="errored")throw a._storedError;Kt(a._readableStreamController)},p=>{throw Br(e,p),a._storedError})}function Fc(e){return Wr(e,!1),e._backpressureChangePromise}function Nr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function vs(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=qr,r.CountQueuingStrategy=Dr,r.ReadableByteStreamController=gt,r.ReadableStream=Ke,r.ReadableStreamBYOBReader=Qt,r.ReadableStreamBYOBRequest=Wt,r.ReadableStreamDefaultController=Ot,r.ReadableStreamDefaultReader=Lt,r.TransformStream=Lr,r.TransformStreamDefaultController=Xt,r.WritableStream=Jt,r.WritableStreamDefaultController=_t,r.WritableStreamDefaultWriter=Ht,Object.defineProperty(r,"__esModule",{value:!0})}))});var uo=Me(()=>{if(!globalThis.ReadableStream)try{let r=require("node:process"),{emitWarning:t}=r;try{r.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),r.emitWarning=t}catch(n){throw r.emitWarning=t,n}}catch{Object.assign(globalThis,co())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(n){let s=0,o=this;return new ReadableStream({type:"bytes",async pull(c){let y=await o.slice(s,Math.min(o.size,s+65536)).arrayBuffer();s+=y.byteLength,c.enqueue(new Uint8Array(y)),s===o.size&&c.close()}})})}catch{}});async function*da(r,t=!0){for(let n of r)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(t){let s=n.byteOffset,o=n.byteOffset+n.byteLength;for(;s!==o;){let c=Math.min(o-s,lo),l=n.buffer.slice(s,s+c);s+=l.byteLength,yield new Uint8Array(l)}}else yield n;else{let s=0,o=n;for(;s!==o.size;){let l=await o.slice(s,Math.min(o.size,s+lo)).arrayBuffer();s+=l.byteLength,yield new Uint8Array(l)}}}var cf,lo,fo,fd,Ne,ar=er(()=>{cf=X(uo(),1);lo=65536;fo=class fa{#t=[];#r="";#e=0;#s="transparent";constructor(t=[],n={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let s=new TextEncoder;for(let c of t){let l;ArrayBuffer.isView(c)?l=new Uint8Array(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)):c instanceof ArrayBuffer?l=new Uint8Array(c.slice(0)):c instanceof fa?l=c:l=s.encode(`${c}`),this.#e+=ArrayBuffer.isView(l)?l.byteLength:l.size,this.#t.push(l)}this.#s=`${n.endings===void 0?"transparent":n.endings}`;let o=n.type===void 0?"":String(n.type);this.#r=/^[\x20-\x7E]*$/.test(o)?o:""}get size(){return this.#e}get type(){return this.#r}async text(){let t=new TextDecoder,n="";for await(let s of da(this.#t,!1))n+=t.decode(s,{stream:!0});return n+=t.decode(),n}async arrayBuffer(){let t=new Uint8Array(this.size),n=0;for await(let s of da(this.#t,!1))t.set(s,n),n+=s.length;return t.buffer}stream(){let t=da(this.#t,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let s=await t.next();s.done?n.close():n.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,n=this.size,s=""){let{size:o}=this,c=t<0?Math.max(o+t,0):Math.min(t,o),l=n<0?Math.max(o+n,0):Math.min(n,o),y=Math.max(l-c,0),f=this.#t,b=[],h=0;for(let _ of f){if(h>=y)break;let E=ArrayBuffer.isView(_)?_.byteLength:_.size;if(c&&E<=c)c-=E,l-=E;else{let O;ArrayBuffer.isView(_)?(O=_.subarray(c,Math.min(E,l)),h+=O.byteLength):(O=_.slice(c,Math.min(E,l)),h+=O.size),l-=E,b.push(O),c=0}}let k=new fa([],{type:String(s).toLowerCase()});return k.#e=y,k.#t=b,k}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(fo.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});fd=fo,Ne=fd});var pd,md,Ct,pa=er(()=>{ar();pd=class extends Ne{#t=0;#r="";constructor(t,n,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s),s===null&&(s={});let o=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(o)||(this.#t=o),this.#r=String(n)}get name(){return this.#r}get lastModified(){return this.#t}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof Ne&&/^(File)$/.test(t[Symbol.toStringTag])}},md=pd,Ct=md});function ho(r,t=Ne){var n=`${po()}${po()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],o=`--${n}\r
Content-Disposition: form-data; name="`;return r.forEach((c,l)=>typeof c=="string"?s.push(o+ma(l)+`"\r
\r
${c.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(o+ma(l)+`"; filename="${ma(c.name,1)}"\r
Content-Type: ${c.type||"application/octet-stream"}\r
\r
`,c,`\r
`)),s.push(`--${n}--`),new t(s,{type:"multipart/form-data; boundary="+n})}var sr,hd,bd,po,yd,mo,ma,dt,ft,an=er(()=>{ar();pa();({toStringTag:sr,iterator:hd,hasInstance:bd}=Symbol),po=Math.random,yd="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),mo=(r,t,n)=>(r+="",/^(Blob|File)$/.test(t&&t[sr])?[(n=n!==void 0?n+"":t[sr]=="File"?t.name:"blob",r),t.name!==n||t[sr]=="blob"?new Ct([t],n,t):t]:[r,t+""]),ma=(r,t)=>(t?r:r.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),dt=(r,t,n)=>{if(t.length<n)throw new TypeError(`Failed to execute '${r}' on 'FormData': ${n} arguments required, but only ${t.length} present.`)},ft=class{#t=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[sr](){return"FormData"}[hd](){return this.entries()}static[bd](t){return t&&typeof t=="object"&&t[sr]==="FormData"&&!yd.some(n=>typeof t[n]!="function")}append(...t){dt("append",arguments,2),this.#t.push(mo(...t))}delete(t){dt("delete",arguments,1),t+="",this.#t=this.#t.filter(([n])=>n!==t)}get(t){dt("get",arguments,1),t+="";for(var n=this.#t,s=n.length,o=0;o<s;o++)if(n[o][0]===t)return n[o][1];return null}getAll(t,n){return dt("getAll",arguments,1),n=[],t+="",this.#t.forEach(s=>s[0]===t&&n.push(s[1])),n}has(t){return dt("has",arguments,1),t+="",this.#t.some(n=>n[0]===t)}forEach(t,n){dt("forEach",arguments,1);for(var[s,o]of this)t.call(n,o,s,this)}set(...t){dt("set",arguments,2);var n=[],s=!0;t=mo(...t),this.#t.forEach(o=>{o[0]===t[0]?s&&(s=!n.push(t)):n.push(o)}),s&&n.push(t),this.#t=n}*entries(){yield*this.#t}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var wo=Me((_f,So)=>{if(!globalThis.DOMException)try{let{MessageChannel:r}=require("worker_threads"),t=new r().port1,n=new ArrayBuffer;t.postMessage(n,[n,n])}catch(r){r.constructor.name==="DOMException"&&(globalThis.DOMException=r.constructor)}So.exports=globalThis.DOMException});var on,gd,Ef,ba=er(()=>{on=require("node:fs"),gd=X(wo(),1);pa();ar();({stat:Ef}=on.promises)});var Oo={};Qn(Oo,{toFormData:()=>Rd});function Ed(r){let t=r.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let n=t[2]||t[3]||"",s=n.slice(n.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(o,c)=>String.fromCharCode(c)),s}async function Rd(r,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let n=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new ya(n[1]||n[2]),o,c,l,y,f,b,h=[],k=new ft,_=j=>{l+=P.decode(j,{stream:!0})},E=j=>{h.push(j)},O=()=>{let j=new Ct(h,b,{type:f});k.append(y,j)},R=()=>{k.append(y,l)},P=new TextDecoder("utf-8");P.decode(),s.onPartBegin=function(){s.onPartData=_,s.onPartEnd=R,o="",c="",l="",y="",f="",b=null,h.length=0},s.onHeaderField=function(j){o+=P.decode(j,{stream:!0})},s.onHeaderValue=function(j){c+=P.decode(j,{stream:!0})},s.onHeaderEnd=function(){if(c+=P.decode(),o=o.toLowerCase(),o==="content-disposition"){let j=c.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);j&&(y=j[2]||j[3]||""),b=Ed(c),b&&(s.onPartData=E,s.onPartEnd=O)}else o==="content-type"&&(f=c);c="",o=""};for await(let j of r)s.write(j);return s.end(),k}var Be,G,_o,rt,cn,un,Sd,ir,wd,_d,Od,kd,pt,ya,ko=er(()=>{ba();an();Be=0,G={START_BOUNDARY:Be++,HEADER_FIELD_START:Be++,HEADER_FIELD:Be++,HEADER_VALUE_START:Be++,HEADER_VALUE:Be++,HEADER_VALUE_ALMOST_DONE:Be++,HEADERS_ALMOST_DONE:Be++,PART_DATA_START:Be++,PART_DATA:Be++,END:Be++},_o=1,rt={PART_BOUNDARY:_o,LAST_BOUNDARY:_o*=2},cn=10,un=13,Sd=32,ir=45,wd=58,_d=97,Od=122,kd=r=>r|32,pt=()=>{},ya=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=pt,this.onHeaderField=pt,this.onHeadersEnd=pt,this.onHeaderValue=pt,this.onPartBegin=pt,this.onPartData=pt,this.onPartEnd=pt,this.boundaryChars={},t=`\r
--`+t;let n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s),this.boundaryChars[n[s]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=G.START_BOUNDARY}write(t){let n=0,s=t.length,o=this.index,{lookbehind:c,boundary:l,boundaryChars:y,index:f,state:b,flags:h}=this,k=this.boundary.length,_=k-1,E=t.length,O,R,P=$=>{this[$+"Mark"]=n},j=$=>{delete this[$+"Mark"]},z=($,L,I,ne)=>{(L===void 0||L!==I)&&this[$](ne&&ne.subarray(L,I))},W=($,L)=>{let I=$+"Mark";I in this&&(L?(z($,this[I],n,t),delete this[I]):(z($,this[I],t.length,t),this[I]=0))};for(n=0;n<s;n++)switch(O=t[n],b){case G.START_BOUNDARY:if(f===l.length-2){if(O===ir)h|=rt.LAST_BOUNDARY;else if(O!==un)return;f++;break}else if(f-1===l.length-2){if(h&rt.LAST_BOUNDARY&&O===ir)b=G.END,h=0;else if(!(h&rt.LAST_BOUNDARY)&&O===cn)f=0,z("onPartBegin"),b=G.HEADER_FIELD_START;else return;break}O!==l[f+2]&&(f=-2),O===l[f+2]&&f++;break;case G.HEADER_FIELD_START:b=G.HEADER_FIELD,P("onHeaderField"),f=0;case G.HEADER_FIELD:if(O===un){j("onHeaderField"),b=G.HEADERS_ALMOST_DONE;break}if(f++,O===ir)break;if(O===wd){if(f===1)return;W("onHeaderField",!0),b=G.HEADER_VALUE_START;break}if(R=kd(O),R<_d||R>Od)return;break;case G.HEADER_VALUE_START:if(O===Sd)break;P("onHeaderValue"),b=G.HEADER_VALUE;case G.HEADER_VALUE:O===un&&(W("onHeaderValue",!0),z("onHeaderEnd"),b=G.HEADER_VALUE_ALMOST_DONE);break;case G.HEADER_VALUE_ALMOST_DONE:if(O!==cn)return;b=G.HEADER_FIELD_START;break;case G.HEADERS_ALMOST_DONE:if(O!==cn)return;z("onHeadersEnd"),b=G.PART_DATA_START;break;case G.PART_DATA_START:b=G.PART_DATA,P("onPartData");case G.PART_DATA:if(o=f,f===0){for(n+=_;n<E&&!(t[n]in y);)n+=k;n-=_,O=t[n]}if(f<l.length)l[f]===O?(f===0&&W("onPartData",!0),f++):f=0;else if(f===l.length)f++,O===un?h|=rt.PART_BOUNDARY:O===ir?h|=rt.LAST_BOUNDARY:f=0;else if(f-1===l.length)if(h&rt.PART_BOUNDARY){if(f=0,O===cn){h&=~rt.PART_BOUNDARY,z("onPartEnd"),z("onPartBegin"),b=G.HEADER_FIELD_START;break}}else h&rt.LAST_BOUNDARY&&O===ir?(z("onPartEnd"),b=G.END,h=0):f=0;if(f>0)c[f-1]=O;else if(o>0){let $=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);z("onPartData",0,o,$),o=0,P("onPartData"),n--}break;case G.END:break;default:throw new Error(`Unexpected state entered: ${b}`)}W("onHeaderField"),W("onHeaderValue"),W("onPartData"),this.index=f,this.state=b,this.flags=h}end(){if(this.state===G.HEADER_FIELD_START&&this.index===0||this.state===G.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==G.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var No=Me((Rp,Fo)=>{function Pe(r,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Fo.exports=Pe;Pe.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Pe.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Pe.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var t=new Date().getTime();if(r&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},n),this._options.unref&&this._timer.unref(),!0};Pe.prototype.attempt=function(r,t){this._fn=r,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Pe.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};Pe.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};Pe.prototype.start=Pe.prototype.try;Pe.prototype.errors=function(){return this._errors};Pe.prototype.attempts=function(){return this._attempts};Pe.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},t=null,n=0,s=0;s<this._errors.length;s++){var o=this._errors[s],c=o.message,l=(r[c]||0)+1;r[c]=l,l>=n&&(t=o,n=l)}return t}});var Qo=Me(bt=>{var Ad=No();bt.operation=function(r){var t=bt.timeouts(r);return new Ad(t,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};bt.timeouts=function(r){if(r instanceof Array)return[].concat(r);var t={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var n in r)t[n]=r[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],o=0;o<t.retries;o++)s.push(this.createTimeout(o,t));return r&&r.forever&&!s.length&&s.push(this.createTimeout(o,t)),s.sort(function(c,l){return c-l}),s};bt.createTimeout=function(r,t){var n=t.randomize?Math.random()+1:1,s=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,r));return s=Math.min(s,t.maxTimeout),s};bt.wrap=function(r,t,n){if(t instanceof Array&&(n=t,t=null),!n){n=[];for(var s in r)typeof r[s]=="function"&&n.push(s)}for(var o=0;o<n.length;o++){var c=n[o],l=r[c];r[c]=function(f){var b=bt.operation(t),h=Array.prototype.slice.call(arguments,1),k=h.pop();h.push(function(_){b.retry(_)||(_&&(arguments[0]=b.mainError()),k.apply(this,arguments))}),b.attempt(function(){f.apply(r,h)})}.bind(r,l),r[c].options=t}}});var Jo=Me(($p,Vo)=>{Vo.exports=Qo()});var Go=Me((Pp,Ho)=>{var Id=Jo();function Md(r,t){function n(s,o){var c=t||{},l;"randomize"in c||(c.randomize=!0),l=Id.operation(c);function y(h){o(h||new Error("Aborted"))}function f(h,k){if(h.bail){y(h);return}l.retry(h)?c.onRetry&&c.onRetry(h,k):o(l.mainError())}function b(h){var k;try{k=r(y,h)}catch(_){f(_,h);return}Promise.resolve(k).then(s).catch(function(E){f(E,h)})}l.attempt(b)}return new Promise(n)}Ho.exports=Md});var Bd={};Qn(Bd,{default:()=>ki});module.exports=Gc(Bd);var Oi=X(require("react")),S=require("@raycast/api");var D=X(require("react")),A=require("@raycast/api");var As=Object.prototype.hasOwnProperty;function Jr(r,t){var n,s;if(r===t)return!0;if(r&&t&&(n=r.constructor)===t.constructor){if(n===Date)return r.getTime()===t.getTime();if(n===RegExp)return r.toString()===t.toString();if(n===Array){if((s=r.length)===t.length)for(;s--&&Jr(r[s],t[s]););return s===-1}if(!n||typeof r=="object"){s=0;for(n in r)if(As.call(r,n)&&++s&&!As.call(t,n)||!(n in t)||!Jr(r[n],t[n]))return!1;return Object.keys(t).length===s}}return r!==r&&t!==t}var lt=X(require("node:fs")),Zr=X(require("node:path")),Bs=X(require("node:crypto")),ra=X(require("node:child_process")),zs=require("node:buffer"),vt=X(require("node:stream")),Ws=require("node:util");var na=require("react/jsx-runtime");var Vn=globalThis;function Yc(r){let t=(0,D.useRef)(r),n=(0,D.useRef)(0);return Jr(r,t.current)||(t.current=r,n.current+=1),(0,D.useMemo)(()=>t.current,[n.current])}function Ee(r){let t=(0,D.useRef)(r);return t.current=r,t}function Kc(r,t){let n=r instanceof Error?r.message:String(r);return(0,A.showToast)({style:A.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??n,primaryAction:t?.primaryAction??Is(r),secondaryAction:t?.primaryAction?Is(r):void 0})}var Is=r=>{let t=!0,n="[Extension Name]...",s="";try{let l=JSON.parse((0,lt.readFileSync)((0,Zr.join)(A.environment.assetsPath,"..","package.json"),"utf8"));n=`[${l.title}]...`,s=`https://raycast.com/${l.owner||l.author}/${l.name}`,(!l.owner||l.access==="public")&&(t=!1)}catch{}let o=A.environment.isDevelopment||t,c=r instanceof Error?r?.stack||r?.message||"":String(r);return{title:o?"Copy Logs":"Report Error",onAction(l){l.hide(),o?A.Clipboard.copy(c):(0,A.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(n)}&extension-url=${encodeURI(s)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${c}
\`\`\`
`)}`)}}};function Zc(r,t,n){let s=(0,D.useRef)(0),[o,c]=(0,D.useState)({isLoading:!0}),l=Ee(r),y=Ee(n?.abortable),f=Ee(t||[]),b=Ee(n?.onError),h=Ee(n?.onData),k=Ee(n?.onWillExecute),_=Ee(n?.failureToastOptions),E=Ee(o.data),O=(0,D.useRef)(null),R=(0,D.useRef)({page:0}),P=(0,D.useRef)(!1),j=(0,D.useRef)(!0),z=(0,D.useRef)(50),W=(0,D.useCallback)(()=>(y.current&&(y.current.current?.abort(),y.current.current=new AbortController),++s.current),[y]),$=(0,D.useCallback)((...Y)=>{let J=W();k.current?.(Y),c(U=>({...U,isLoading:!0}));let ue=Xc(l.current)(...Y);function ae(U){return U.name=="AbortError"||J===s.current&&(b.current?b.current(U):A.environment.launchType!==A.LaunchType.Background&&Kc(U,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(se){se.hide(),O.current?.(...f.current||[])}},..._.current}),c({error:U,isLoading:!1})),U}return typeof ue=="function"?(P.current=!0,ue(R.current).then(({data:U,hasMore:se,cursor:F})=>(J===s.current&&(R.current&&(R.current.cursor=F,R.current.lastItem=U?.[U.length-1]),h.current&&h.current(U,R.current),se&&(z.current=U.length),j.current=se,c(K=>R.current.page===0?{data:U,isLoading:!1}:{data:(K.data||[])?.concat(U),isLoading:!1})),U),U=>(j.current=!1,ae(U)))):(P.current=!1,ue.then(U=>(J===s.current&&(h.current&&h.current(U),c({data:U,isLoading:!1})),U),ae))},[h,b,f,l,c,O,k,R,_,W]);O.current=$;let L=(0,D.useCallback)(()=>{R.current={page:0};let Y=f.current||[];return $(...Y)},[$,f]),I=(0,D.useCallback)(async(Y,J)=>{let ue;try{if(J?.optimisticUpdate){W(),typeof J?.rollbackOnError!="function"&&J?.rollbackOnError!==!1&&(ue=structuredClone(E.current?.value));let ae=J.optimisticUpdate;c(U=>({...U,data:ae(U.data)}))}return await Y}catch(ae){if(typeof J?.rollbackOnError=="function"){let U=J.rollbackOnError;c(se=>({...se,data:U(se.data)}))}else J?.optimisticUpdate&&J?.rollbackOnError!==!1&&c(U=>({...U,data:ue}));throw ae}finally{J?.shouldRevalidateAfter!==!1&&(A.environment.launchType===A.LaunchType.Background||A.environment.commandMode==="menu-bar"?await L():L())}},[L,E,c,W]),ne=(0,D.useCallback)(()=>{R.current.page+=1;let Y=f.current||[];$(...Y)},[R,f,$]);(0,D.useEffect)(()=>{R.current={page:0},n?.execute!==!1?$(...t||[]):W()},[Yc([t,n?.execute,$]),y,R]),(0,D.useEffect)(()=>()=>{W()},[W]);let ee=n?.execute!==!1?o.isLoading:!1,nt={...o,isLoading:ee},Te=P.current?{pageSize:z.current,hasMore:j.current,onLoadMore:ne}:void 0;return{...nt,revalidate:L,mutate:I,pagination:Te}}function Xc(r){return r===Promise.all||r===Promise.race||r===Promise.resolve||r===Promise.reject?r.bind(Promise):r}function Ms(r){return typeof r!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(r))!==null}function eu(r){return r instanceof URLSearchParams?r.toString():r}function Fs(r,t=[]){function n(s){return"update"in r?r.update(s,"utf8"):r.write(s)}return{dispatch:function(s){s=eu(s),s===null?this._null():this["_"+typeof s](s)},_object:function(s){let o=/\[object (.*)\]/i,c=Object.prototype.toString.call(s),l=o.exec(c)?.[1]??"unknown:["+c+"]";l=l.toLowerCase();let y=null;if((y=t.indexOf(s))>=0){this.dispatch("[CIRCULAR:"+y+"]");return}else t.push(s);if(Buffer.isBuffer(s))return n("buffer:"),n(s.toString("utf8"));if(l!=="object"&&l!=="function"&&l!=="asyncfunction")if(this["_"+l])this["_"+l](s);else throw new Error('Unknown object type "'+l+'"');else{let f=Object.keys(s);f=f.sort(),Ms(s)||f.splice(0,0,"prototype","__proto__","constructor"),n("object:"+f.length+":");let b=this;return f.forEach(function(h){b.dispatch(h),n(":"),b.dispatch(s[h]),n(",")})}},_array:function(s,o){o=typeof o<"u"?o:!1;let c=this;if(n("array:"+s.length+":"),!o||s.length<=1){s.forEach(function(f){c.dispatch(f)});return}let l=[],y=s.map(function(f){let b=tu(),h=t.slice();return Fs(b,h).dispatch(f),l=l.concat(h.slice(t.length)),b.read().toString()});t=t.concat(l),y.sort(),this._array(y,!1)},_date:function(s){n("date:"+s.toJSON())},_symbol:function(s){n("symbol:"+s.toString())},_error:function(s){n("error:"+s.toString())},_boolean:function(s){n("bool:"+s.toString())},_string:function(s){n("string:"+s.length+":"),n(s.toString())},_function:function(s){n("fn:"),Ms(s)?this.dispatch("[native]"):this.dispatch(s.toString()),this.dispatch("function-name:"+String(s.name)),this._object(s)},_number:function(s){n("number:"+s.toString())},_xml:function(s){n("xml:"+s.toString())},_null:function(){n("Null")},_undefined:function(){n("Undefined")},_regexp:function(s){n("regex:"+s.toString())},_uint8array:function(s){n("uint8array:"),this.dispatch(Array.prototype.slice.call(s))},_uint8clampedarray:function(s){n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(s))},_int8array:function(s){n("int8array:"),this.dispatch(Array.prototype.slice.call(s))},_uint16array:function(s){n("uint16array:"),this.dispatch(Array.prototype.slice.call(s))},_int16array:function(s){n("int16array:"),this.dispatch(Array.prototype.slice.call(s))},_uint32array:function(s){n("uint32array:"),this.dispatch(Array.prototype.slice.call(s))},_int32array:function(s){n("int32array:"),this.dispatch(Array.prototype.slice.call(s))},_float32array:function(s){n("float32array:"),this.dispatch(Array.prototype.slice.call(s))},_float64array:function(s){n("float64array:"),this.dispatch(Array.prototype.slice.call(s))},_arraybuffer:function(s){n("arraybuffer:"),this.dispatch(new Uint8Array(s))},_url:function(s){n("url:"+s.toString())},_map:function(s){n("map:");let o=Array.from(s);this._array(o,!0)},_set:function(s){n("set:");let o=Array.from(s);this._array(o,!0)},_file:function(s){n("file:"),this.dispatch([s.name,s.size,s.type,s.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){n("domwindow")},_bigint:function(s){n("bigint:"+s.toString())},_process:function(){n("process")},_timer:function(){n("timer")},_pipe:function(){n("pipe")},_tcp:function(){n("tcp")},_udp:function(){n("udp")},_tty:function(){n("tty")},_statwatcher:function(){n("statwatcher")},_securecontext:function(){n("securecontext")},_connection:function(){n("connection")},_zlib:function(){n("zlib")},_context:function(){n("context")},_nodescript:function(){n("nodescript")},_httpparser:function(){n("httpparser")},_dataview:function(){n("dataview")},_signal:function(){n("signal")},_fsevent:function(){n("fsevent")},_tlswrap:function(){n("tlswrap")}}}function tu(){return{buf:"",write:function(r){this.buf+=r},end:function(r){this.buf+=r},read:function(){return this.buf}}}function ru(r,t){let n=this[r];return n instanceof Date?`__raycast_cached_date__${n.toISOString()}`:Buffer.isBuffer(n)?`__raycast_cached_buffer__${n.toString("base64")}`:t}function nu(r,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function Us(r){let t=Bs.default.createHash("sha1");return Fs(t).dispatch(r),t.digest("hex")}var au=Symbol("cache without namespace"),qs=new Map;function aa(r,t,n){let s=n?.cacheNamespace||au,o=qs.get(s)||qs.set(s,new A.Cache({namespace:n?.cacheNamespace})).get(s);if(!o)throw new Error("Missing cache");let c=Ee(r),l=Ee(t),y=(0,D.useSyncExternalStore)(o.subscribe,()=>{try{return o.get(c.current)}catch(k){console.error("Could not get Cache data:",k);return}}),f=(0,D.useMemo)(()=>{if(typeof y<"u"){if(y==="undefined")return;try{return JSON.parse(y,nu)}catch(k){return console.warn("The cached data is corrupted",k),l.current}}else return l.current},[y,l]),b=Ee(f),h=(0,D.useCallback)(k=>{let _=typeof k=="function"?k(b.current):k;if(typeof _>"u")o.set(c.current,"undefined");else{let E=JSON.stringify(_,ru);o.set(c.current,E)}return _},[o,c,b]);return[f,h]}var Pt=Symbol();function Re(r,t,n){let{initialData:s,keepPreviousData:o,internal_cacheKeySuffix:c,...l}=n||{},y=(0,D.useRef)(null),[f,b]=aa(Us(t||[])+c,Pt,{cacheNamespace:Us(r)}),h=(0,D.useRef)(f!==Pt?f:s),k=(0,D.useRef)(void 0),{mutate:_,revalidate:E,...O}=Zc(r,t||[],{...l,onData(W,$){k.current=$,l.onData&&l.onData(W,$),!($&&$.page>0)&&(y.current="promise",h.current=W,b(W))}}),R,P=O.pagination;k.current&&k.current.page>0&&O.data?R=O.data:y.current==="promise"?R=h.current:o&&f!==Pt?(R=f,P&&(P.hasMore=!0,P.pageSize=f.length)):o&&f===Pt?R=h.current:f!==Pt?(R=f,P&&(P.hasMore=!0,P.pageSize=f.length)):R=s;let j=Ee(R),z=(0,D.useCallback)(async(W,$)=>{let L;try{if($?.optimisticUpdate){typeof $?.rollbackOnError!="function"&&$?.rollbackOnError!==!1&&(L=structuredClone(j.current));let I=$.optimisticUpdate(j.current);y.current="cache",h.current=I,b(I)}return await _(W,{shouldRevalidateAfter:$?.shouldRevalidateAfter})}catch(I){if(typeof $?.rollbackOnError=="function"){let ne=$.rollbackOnError(j.current);y.current="cache",h.current=ne,b(ne)}else $?.optimisticUpdate&&$?.rollbackOnError!==!1&&(y.current="cache",h.current=L,b(L));throw I}},[b,_,j,h,y]);return(0,D.useEffect)(()=>{f!==Pt&&(y.current="cache",h.current=f)},[f]),{data:R,isLoading:O.isLoading,error:O.error,mutate:k.current&&k.current.page>0?_:z,pagination:P,revalidate:E}}var Gr=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",Jn=Symbol.for("signal-exit emitter"),Zn=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Vn[Jn])return Vn[Jn];Object.defineProperty(Vn,Jn,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,n){this.listeners[t].push(n)}removeListener(t,n){let s=this.listeners[t],o=s.indexOf(n);o!==-1&&(o===0&&s.length===1?s.length=0:s.splice(o,1))}emit(t,n,s){if(this.emitted[t])return!1;this.emitted[t]=!0;let o=!1;for(let c of this.listeners[t])o=c(n,s)===!0||o;return t==="exit"&&(o=this.emit("afterExit",n,s)||o),o}},Xn=class{onExit(){return()=>{}}load(){}unload(){}},ea=class{#t;#r;#e;#s;#i;#o;#a;#n;constructor(t){this.#t=process.platform==="win32"?"SIGINT":"SIGHUP",this.#r=new Zn,this.#o={},this.#a=!1,this.#n=[],this.#n.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#n.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#n.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#o={};for(let n of this.#n)this.#o[n]=()=>{let s=this.#e.listeners(n),{count:o}=this.#r,c=t;if(typeof c.__signal_exit_emitter__=="object"&&typeof c.__signal_exit_emitter__.count=="number"&&(o+=c.__signal_exit_emitter__.count),s.length===o){this.unload();let l=this.#r.emit("exit",null,n),y=n==="SIGHUP"?this.#t:n;l||t.kill(t.pid,y)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,n){if(!Gr(this.#e))return()=>{};this.#a===!1&&this.load();let s=n?.alwaysLast?"afterExit":"exit";return this.#r.on(s,t),()=>{this.#r.removeListener(s,t),this.#r.listeners.exit.length===0&&this.#r.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#a){this.#a=!0,this.#r.count+=1;for(let t of this.#n)try{let n=this.#o[t];n&&this.#e.on(t,n)}catch{}this.#e.emit=(t,...n)=>this.#u(t,...n),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#a&&(this.#a=!1,this.#n.forEach(t=>{let n=this.#o[t];if(!n)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,n)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#r.count-=1)}#c(t){return Gr(this.#e)?(this.#e.exitCode=t||0,this.#r.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#u(t,...n){let s=this.#s;if(t==="exit"&&Gr(this.#e)){typeof n[0]=="number"&&(this.#e.exitCode=n[0]);let o=s.call(this.#e,t,...n);return this.#r.emit("exit",this.#e.exitCode,null),o}else return s.call(this.#e,t,...n)}},Hn=null,su=(r,t)=>(Hn||(Hn=Gr(process)?new ea(process):new Xn),Hn.onExit(r,t));function Ns(r,{timeout:t}={}){let n=new Promise((y,f)=>{r.on("exit",(b,h)=>{y({exitCode:b,signal:h,timedOut:!1})}),r.on("error",b=>{f(b)}),r.stdin&&r.stdin.on("error",b=>{f(b)})}),s=su(()=>{r.kill()});if(t===0||t===void 0)return n.finally(()=>s());let o,c=new Promise((y,f)=>{o=setTimeout(()=>{r.kill("SIGTERM"),f(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),l=n.finally(()=>{clearTimeout(o)});return Promise.race([c,l]).finally(()=>s())}var ta=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function ou(r){let{encoding:t}=r,n=t==="buffer",s=new vt.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&s.setEncoding(t);let o=0,c=[];return s.on("data",l=>{c.push(l),o+=l.length}),s.getBufferedValue=()=>n?Buffer.concat(c,o):c.join(""),s.getBufferedLength=()=>o,s}async function Ds(r,t){let n=ou(t);return await new Promise((s,o)=>{let c=l=>{l&&n.getBufferedLength()<=zs.constants.MAX_LENGTH&&(l.bufferedData=n.getBufferedValue()),o(l)};(async()=>{try{await(0,Ws.promisify)(vt.default.pipeline)(r,n),s()}catch(l){c(l)}})(),n.on("data",()=>{n.getBufferedLength()>8e7&&c(new ta)})}),n.getBufferedValue()}async function Ls(r,t){r.destroy();try{return await t}catch(n){return n.bufferedData}}async function Qs({stdout:r,stderr:t},{encoding:n},s){let o=Ds(r,{encoding:n}),c=Ds(t,{encoding:n});try{return await Promise.all([s,o,c])}catch(l){return Promise.all([{error:l,exitCode:null,signal:l.signal,timedOut:l.timedOut||!1},Ls(r,o),Ls(t,c)])}}function iu(r){let t=typeof r=="string"?`
`:10,n=typeof r=="string"?"\r":13;return r[r.length-1]===t&&(r=r.slice(0,-1)),r[r.length-1]===n&&(r=r.slice(0,-1)),r}function Yr(r,t){return r.stripFinalNewline?iu(t):t}function cu({timedOut:r,timeout:t,signal:n,exitCode:s}){return r?`timed out after ${t} milliseconds`:n!=null?`was killed with ${n}`:s!=null?`failed with exit code ${s}`:"failed"}function uu({stdout:r,stderr:t,error:n,signal:s,exitCode:o,command:c,timedOut:l,options:y,parentError:f}){let h=`Command ${cu({timedOut:l,timeout:y?.timeout,signal:s,exitCode:o})}: ${c}`,k=n?`${h}
${n.message}`:h,_=[k,t,r].filter(Boolean).join(`
`);return n?n.originalMessage=n.message:n=f,n.message=_,n.shortMessage=k,n.command=c,n.exitCode=o,n.signal=s,n.stdout=r,n.stderr=t,"bufferedData"in n&&delete n.bufferedData,n}function Vs({stdout:r,stderr:t,error:n,exitCode:s,signal:o,timedOut:c,command:l,options:y,parentError:f}){if(n||s!==0||o!==null)throw uu({error:n,exitCode:s,signal:o,stdout:r,stderr:t,command:l,timedOut:c,options:y,parentError:f});return r}var Hr={asana:"1191201745684312",github:"7235fe8d42157f1f38c0",linear:"c8ff37b9225c3c9aefd7d66ea0e5b6f1",slack:"851756884692.5546927290212"},Kr=class r{constructor(t){this.clientId=t.clientId,this.scope=Array.isArray(t.scope)?t.scope.join(" "):t.scope,this.personalAccessToken=t.personalAccessToken,this.bodyEncoding=t.bodyEncoding,this.client=t.client,this.extraParameters=t.extraParameters,this.authorizeUrl=t.authorizeUrl,this.tokenUrl=t.tokenUrl,this.refreshTokenUrl=t.refreshTokenUrl,this.onAuthorize=t.onAuthorize,this.tokenResponseParser=t.tokenResponseParser??(n=>n),this.tokenRefreshResponseParser=t.tokenRefreshResponseParser??(n=>n),this.authorize=this.authorize.bind(this)}static asana(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.Web,providerName:"Asana",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="251" height="232" fill="none"><path fill="#F06A6A" d="M179.383 54.373c0 30.017-24.337 54.374-54.354 54.374-30.035 0-54.373-24.338-54.373-54.374C70.656 24.338 94.993 0 125.029 0c30.017 0 54.354 24.338 54.354 54.373ZM54.393 122.33C24.376 122.33.02 146.668.02 176.685c0 30.017 24.337 54.373 54.373 54.373 30.035 0 54.373-24.338 54.373-54.373 0-30.017-24.338-54.355-54.373-54.355Zm141.253 0c-30.035 0-54.373 24.338-54.373 54.374 0 30.035 24.338 54.373 54.373 54.373 30.017 0 54.374-24.338 54.374-54.373 0-30.036-24.338-54.374-54.374-54.374Z"/></svg>')}`,providerId:"asana",description:"Connect your Asana account"}),clientId:t.clientId??Hr.asana,authorizeUrl:t.authorizeUrl??"https://asana.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://asana.oauth.raycast.com/token",refreshTokenUrl:t.refreshTokenUrl??"https://asana.oauth.raycast.com/refresh-token",scope:t.scope,personalAccessToken:t.personalAccessToken,onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static github(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.Web,providerName:"GitHub",providerIcon:{source:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>')}`,tintColor:A.Color.PrimaryText},providerId:"github",description:"Connect your GitHub account"}),clientId:t.clientId??Hr.github,authorizeUrl:t.authorizeUrl??"https://github.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://github.oauth.raycast.com/token",refreshTokenUrl:t.refreshTokenUrl??"https://github.oauth.raycast.com/refresh-token",scope:t.scope,personalAccessToken:t.personalAccessToken,onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static google(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.AppURI,providerName:"Google",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" style="display:block" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/><path fill="none" d="M0 0h48v48H0z"/></svg>')}`,providerId:"google",description:"Connect your Google account"}),clientId:t.clientId,authorizeUrl:t.authorizeUrl??"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:t.tokenUrl??"https://oauth2.googleapis.com/token",refreshTokenUrl:t.tokenUrl,scope:t.scope,personalAccessToken:t.personalAccessToken,bodyEncoding:t.bodyEncoding??"url-encoded",onAuthorize:t.onAuthorize,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static jira(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.Web,providerName:"Jira",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2361" height="2500" viewBox="2.59 0 214.091 224"><linearGradient id="a" x1="102.4" x2="56.15" y1="218.63" y2="172.39" gradientTransform="matrix(1 0 0 -1 0 264)" gradientUnits="userSpaceOnUse"><stop offset=".18" stop-color="#0052cc"/><stop offset="1" stop-color="#2684ff"/></linearGradient><linearGradient xlink:href="#a" id="b" x1="114.65" x2="160.81" y1="85.77" y2="131.92"/><path fill="#2684ff" d="M214.06 105.73 117.67 9.34 108.33 0 35.77 72.56 2.59 105.73a8.89 8.89 0 0 0 0 12.54l66.29 66.29L108.33 224l72.55-72.56 1.13-1.12 32.05-32a8.87 8.87 0 0 0 0-12.59zm-105.73 39.39L75.21 112l33.12-33.12L141.44 112z"/><path fill="url(#a)" d="M108.33 78.88a55.75 55.75 0 0 1-.24-78.61L35.62 72.71l39.44 39.44z"/><path fill="url(#b)" d="m141.53 111.91-33.2 33.21a55.77 55.77 0 0 1 0 78.86L181 151.35z"/></svg>')}`,providerId:"jira",description:"Connect your Jira account"}),clientId:t.clientId,authorizeUrl:t.authorizeUrl??"https://auth.atlassian.com/authorize",tokenUrl:t.tokenUrl??"https://auth.atlassian.com/oauth/token",refreshTokenUrl:t.refreshTokenUrl,scope:t.scope,personalAccessToken:t.personalAccessToken,onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static linear(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.Web,providerName:"Linear",providerIcon:{source:{light:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" fill="#222326" width="200" height="200" viewBox="0 0 100 100"><path d="M1.22541 61.5228c-.2225-.9485.90748-1.5459 1.59638-.857L39.3342 97.1782c.6889.6889.0915 1.8189-.857 1.5964C20.0515 94.4522 5.54779 79.9485 1.22541 61.5228ZM.00189135 46.8891c-.01764375.2833.08887215.5599.28957165.7606L52.3503 99.7085c.2007.2007.4773.3075.7606.2896 2.3692-.1476 4.6938-.46 6.9624-.9259.7645-.157 1.0301-1.0963.4782-1.6481L2.57595 39.4485c-.55186-.5519-1.49117-.2863-1.648174.4782-.465915 2.2686-.77832 4.5932-.92588465 6.9624ZM4.21093 29.7054c-.16649.3738-.08169.8106.20765 1.1l64.77602 64.776c.2894.2894.7262.3742 1.1.2077 1.7861-.7956 3.5171-1.6927 5.1855-2.684.5521-.328.6373-1.0867.1832-1.5407L8.43566 24.3367c-.45409-.4541-1.21271-.3689-1.54074.1832-.99132 1.6684-1.88843 3.3994-2.68399 5.1855ZM12.6587 18.074c-.3701-.3701-.393-.9637-.0443-1.3541C21.7795 6.45931 35.1114 0 49.9519 0 77.5927 0 100 22.4073 100 50.0481c0 14.8405-6.4593 28.1724-16.7199 37.3375-.3903.3487-.984.3258-1.3542-.0443L12.6587 18.074Z"/></svg>')}`,dark:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" fill="#fff" width="200" height="200" viewBox="0 0 100 100"><path d="M1.22541 61.5228c-.2225-.9485.90748-1.5459 1.59638-.857L39.3342 97.1782c.6889.6889.0915 1.8189-.857 1.5964C20.0515 94.4522 5.54779 79.9485 1.22541 61.5228ZM.00189135 46.8891c-.01764375.2833.08887215.5599.28957165.7606L52.3503 99.7085c.2007.2007.4773.3075.7606.2896 2.3692-.1476 4.6938-.46 6.9624-.9259.7645-.157 1.0301-1.0963.4782-1.6481L2.57595 39.4485c-.55186-.5519-1.49117-.2863-1.648174.4782-.465915 2.2686-.77832 4.5932-.92588465 6.9624ZM4.21093 29.7054c-.16649.3738-.08169.8106.20765 1.1l64.77602 64.776c.2894.2894.7262.3742 1.1.2077 1.7861-.7956 3.5171-1.6927 5.1855-2.684.5521-.328.6373-1.0867.1832-1.5407L8.43566 24.3367c-.45409-.4541-1.21271-.3689-1.54074.1832-.99132 1.6684-1.88843 3.3994-2.68399 5.1855ZM12.6587 18.074c-.3701-.3701-.393-.9637-.0443-1.3541C21.7795 6.45931 35.1114 0 49.9519 0 77.5927 0 100 22.4073 100 50.0481c0 14.8405-6.4593 28.1724-16.7199 37.3375-.3903.3487-.984.3258-1.3542-.0443L12.6587 18.074Z" /></svg>')}`}},providerId:"linear",description:"Connect your Linear account"}),clientId:t.clientId??Hr.linear,authorizeUrl:t.authorizeUrl??"https://linear.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://linear.oauth.raycast.com/token",refreshTokenUrl:t.refreshTokenUrl??"https://linear.oauth.raycast.com/refresh-token",scope:t.scope,extraParameters:{actor:"user"},onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static slack(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.Web,providerName:"Slack",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="73 73 124 124"><style>.st0{fill:#e01e5a}.st1{fill:#36c5f0}.st2{fill:#2eb67d}.st3{fill:#ecb22e}</style><path d="M99.4 151.2c0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9h12.9v12.9zM105.9 151.2c0-7.1 5.8-12.9 12.9-12.9s12.9 5.8 12.9 12.9v32.3c0 7.1-5.8 12.9-12.9 12.9s-12.9-5.8-12.9-12.9v-32.3z" class="st0"/><path d="M118.8 99.4c-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9s12.9 5.8 12.9 12.9v12.9h-12.9zM118.8 105.9c7.1 0 12.9 5.8 12.9 12.9s-5.8 12.9-12.9 12.9H86.5c-7.1 0-12.9-5.8-12.9-12.9s5.8-12.9 12.9-12.9h32.3z" class="st1"/><path d="M170.6 118.8c0-7.1 5.8-12.9 12.9-12.9 7.1 0 12.9 5.8 12.9 12.9s-5.8 12.9-12.9 12.9h-12.9v-12.9zM164.1 118.8c0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9V86.5c0-7.1 5.8-12.9 12.9-12.9 7.1 0 12.9 5.8 12.9 12.9v32.3z" class="st2"/><path d="M151.2 170.6c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9v-12.9h12.9zM151.2 164.1c-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9h32.3c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9h-32.3z" class="st3"/></svg>')}`,providerId:"slack",description:"Connect your Slack account"}),clientId:t.clientId??Hr.slack,authorizeUrl:t.authorizeUrl??"https://slack.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://slack.oauth.raycast.com/token",refreshTokenUrl:t.tokenUrl??"https://slack.oauth.raycast.com/refresh-token",scope:"",extraParameters:{user_scope:t.scope},personalAccessToken:t.personalAccessToken,bodyEncoding:t.tokenUrl?t.bodyEncoding??"url-encoded":"json",onAuthorize:t.onAuthorize,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser??(n=>({access_token:n.authed_user.access_token,scope:n.authed_user.scope}))})}static zoom(t){return new r({client:new A.OAuth.PKCEClient({redirectMethod:A.OAuth.RedirectMethod.Web,providerName:"Zoom",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 351.845 80"><path d="M73.786 78.835H10.88A10.842 10.842 0 0 1 .833 72.122a10.841 10.841 0 0 1 2.357-11.85L46.764 16.7h-31.23C6.954 16.699 0 9.744 0 1.165h58.014c4.414 0 8.357 2.634 10.046 6.712a10.843 10.843 0 0 1-2.356 11.85L22.13 63.302h36.122c8.58 0 15.534 6.955 15.534 15.534Zm278.059-48.544C351.845 13.588 338.256 0 321.553 0c-8.934 0-16.975 3.89-22.524 10.063C293.48 3.89 285.44 0 276.505 0c-16.703 0-30.291 13.588-30.291 30.291v48.544c8.579 0 15.534-6.955 15.534-15.534v-33.01c0-8.137 6.62-14.757 14.757-14.757s14.757 6.62 14.757 14.757v33.01c0 8.58 6.955 15.534 15.534 15.534V30.291c0-8.137 6.62-14.757 14.757-14.757s14.758 6.62 14.758 14.757v33.01c0 8.58 6.954 15.534 15.534 15.534V30.291ZM238.447 40c0 22.091-17.909 40-40 40s-40-17.909-40-40 17.908-40 40-40 40 17.909 40 40Zm-15.534 0c0-13.512-10.954-24.466-24.466-24.466S173.98 26.488 173.98 40s10.953 24.466 24.466 24.466S222.913 53.512 222.913 40Zm-70.68 0c0 22.091-17.909 40-40 40s-40-17.909-40-40 17.909-40 40-40 40 17.909 40 40Zm-15.534 0c0-13.512-10.954-24.466-24.466-24.466S87.767 26.488 87.767 40s10.954 24.466 24.466 24.466S136.699 53.512 136.699 40Z" style="fill:#0b5cff"/></svg>')}`,providerId:"zoom",description:"Connect your Zoom account"}),clientId:t.clientId,authorizeUrl:t.authorizeUrl??"https://zoom.us/oauth/authorize",tokenUrl:t.tokenUrl??"https://zoom.us/oauth/token",refreshTokenUrl:t.refreshTokenUrl,scope:t.scope,personalAccessToken:t.personalAccessToken,bodyEncoding:t.bodyEncoding??"url-encoded",onAuthorize:t.onAuthorize,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}async authorize(){let t=await this.client.getTokens();if(t?.accessToken){if(t.refreshToken&&t.isExpired()){let c=await this.refreshTokens({token:t.refreshToken});if(c)return await this.client.setTokens(c),c.access_token}return t.accessToken}let n=await this.client.authorizationRequest({endpoint:this.authorizeUrl,clientId:this.clientId,scope:this.scope,extraParameters:this.extraParameters}),{authorizationCode:s}=await this.client.authorize(n),o=await this.fetchTokens({authRequest:n,authorizationCode:s});return await this.client.setTokens(o),o.access_token}async fetchTokens({authRequest:t,authorizationCode:n}){let s;if(this.bodyEncoding==="url-encoded"){let l=new URLSearchParams;l.append("client_id",this.clientId),l.append("code",n),l.append("code_verifier",t.codeVerifier),l.append("grant_type","authorization_code"),l.append("redirect_uri",t.redirectURI),s={body:l}}else s={body:JSON.stringify({client_id:this.clientId,code:n,code_verifier:t.codeVerifier,grant_type:"authorization_code",redirect_uri:t.redirectURI}),headers:{"Content-Type":"application/json"}};let o=await fetch(this.tokenUrl,{method:"POST",...s});if(!o.ok){let l=await o.text();throw console.error("fetch tokens error:",l),new Error(`Error while fetching tokens: ${o.status} (${o.statusText})
${l}`)}let c=this.tokenResponseParser(await o.json());return Array.isArray(c.scope)?{...c,scope:c.scope.join(" ")}:c}async refreshTokens({token:t}){let n;if(this.bodyEncoding==="url-encoded"){let o=new URLSearchParams;o.append("client_id",this.clientId),o.append("refresh_token",t),o.append("grant_type","refresh_token"),n={body:o}}else n={body:JSON.stringify({client_id:this.clientId,refresh_token:t,grant_type:"refresh_token"}),headers:{"Content-Type":"application/json"}};let s=await fetch(this.refreshTokenUrl??this.tokenUrl,{method:"POST",...n});if(s.ok){let o=this.tokenRefreshResponseParser(await s.json());return o.refresh_token=o.refresh_token??t,o}else{let o=await s.text();console.error("refresh tokens error:",o),this.client.description=`${this.client.providerName} needs you to sign-in again. Press \u23CE or click the button below to continue.`,await this.client.removeTokens(),await this.authorize()}}},Tt=null,tr=null,Gn=null,Yn=null,Kn=null;function Js(r){return A.environment.commandMode==="no-view"?t=>async s=>{if(!Tt){Tt=r.personalAccessToken??await r.authorize(),tr=r.personalAccessToken?"personal":"oauth";let o=(await r.client?.getTokens())?.idToken;r.onAuthorize&&await Promise.resolve(r.onAuthorize({token:Tt,type:tr,idToken:o}))}return t(s)}:t=>{let n=s=>{r.personalAccessToken?(Tt=r.personalAccessToken,tr="personal"):(Gn||(Gn=r.authorize()),Tt=D.default.use(Gn),tr="oauth");let o;return r.client&&(Yn||(Yn=r.client?.getTokens().then(c=>c?.idToken)),o=D.default.use(Yn)),r.onAuthorize&&(Kn||(Kn=Promise.resolve(r.onAuthorize({token:Tt,type:tr,idToken:o}))),D.default.use(Kn)),(0,na.jsx)(t,{...s})};return n.displayName=`withAccessToken(${t.displayName||t.name})`,n}}async function jt(r,t,n){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:s,language:o,timeout:c,...l}=Array.isArray(t)?n||{}:t||{},y=s!==!1?[]:["-ss"];o==="JavaScript"&&y.push("-l","JavaScript"),Array.isArray(t)&&y.push("-",...t);let f=ra.default.spawn("osascript",y,{...l,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),b=Ns(f,{timeout:c??1e4});f.stdin.end(r);let[{error:h,exitCode:k,signal:_,timedOut:E},O,R]=await Qs(f,{encoding:"utf8"},b),P=Yr({stripFinalNewline:!0},O),j=Yr({stripFinalNewline:!0},R);return Vs({stdout:P,stderr:j,error:h,exitCode:k,signal:_,timedOut:E,command:"osascript",options:n,parentError:new Error})}async function sa(r,t){if(process.platform!=="win32")throw new Error("PowerShell is only supported on Windows");let{timeout:n,...s}=t||{},o=["-NoLogo","-NoProfile","-NonInteractive","-Command","-"],c=ra.default.spawn("powershell.exe",o,{...s}),l=Ns(c,{timeout:n??1e4});c.stdin.end(r);let[{error:y,exitCode:f,signal:b,timedOut:h},k,_]=await Qs(c,{encoding:"utf8"},l),E=Yr({stripFinalNewline:!0},k),O=Yr({stripFinalNewline:!0},_);return Vs({stdout:E,stderr:O,error:y,exitCode:f,signal:b,timedOut:h,command:"powershell.exe",options:t,parentError:new Error})}var Ks=X(Xr());function C(r){if(console.log("--- start getErrorMessage ---"),console.log("error",r),console.log("--- end getErrorMessage ---"),r instanceof Ks.HttpError)try{return JSON.parse(r.data).error.message}catch{return typeof r.data=="string"?r.data:r.data.error.message}return r instanceof Error?r.message:String(r)}var Zs=require("@raycast/api");function tt(r){return`
    tell application "Spotify"
      if not application "Spotify" is running then
        activate

        set _maxOpenWaitTimeInSeconds to 5
        set _openCounter to 1
        repeat until application "Spotify" is running
          delay 1
          set _openCounter to _openCounter + 1
          if _openCounter > _maxOpenWaitTimeInSeconds then exit repeat
        end repeat
      end if
      ${r}
    end tell`}async function Xs(r){await(0,Zs.closeMainWindow)(),await jt(r)}var en=class extends Error{constructor(t){super(t),this.name="WinNotSupportedError"}};async function ie(r,t=!1,n,s){process.platform==="win32"?await fu(r,n):await pu(r,t,n,s)}async function fu(r,t){let n=`
  Add-Type -AssemblyName System.Runtime.WindowsRuntime
$asTaskGeneric = ([System.WindowsRuntimeSystemExtensions].GetMethods() | Where-Object { $_.Name -eq 'AsTask' -and $_.GetParameters().Count -eq 1 -and $_.GetParameters()[0].ParameterType.Name -eq 'IAsyncOperation\`1' })[0]

Function Await($WinRtTask, $ResultType) {
    $asTask = $asTaskGeneric.MakeGenericMethod($ResultType)
    $netTask = $asTask.Invoke($null, @($WinRtTask))
    $netTask.Wait(-1) | Out-Null
    $netTask.Result
}

Function Get-SpotifySession {
    [Windows.Media.Control.GlobalSystemMediaTransportControlsSessionManager,Windows.Media.Control,ContentType=WindowsRuntime] | Out-Null
    $mediaManager = Await ([Windows.Media.Control.GlobalSystemMediaTransportControlsSessionManager]::RequestAsync()) ([Windows.Media.Control.GlobalSystemMediaTransportControlsSessionManager])

    $sessions = $mediaManager.GetSessions()
    $spotifySession = $sessions | Where-Object {
        $_.SourceAppUserModelId -match "Spotify"
    }

    return $spotifySession
}

Function Start-Spotify {
    try {
        Start-Process "spotify:"

        $timeout = 15
        $elapsed = 0
        while ($elapsed -lt $timeout) {
            Start-Sleep -Seconds 1
            $elapsed++

            $session = Get-SpotifySession
            if ($session) {
                return $session
            }
        }

        return $null

    } catch {
        return $null
    }
}

Function Ensure-SpotifyRunning {
    $session = Get-SpotifySession

    if (-not $session) {
        $session = Start-Spotify

        if (-not $session) {
            # One more try after startup
            Start-Sleep -Seconds 2
            $session = Get-SpotifySession
        }
    }

    return $session
}
  `,s=async o=>{let c=`
${n}
$session = Ensure-SpotifyRunning
    if ($session) {
     Await ($session.${o}) ([bool])
  }
    `;await sa(c)};switch(r){case 0:await s("TryPlayAsync()");break;case 1:await s("TryPauseAsync()");break;case 2:await s("TrySkipNextAsync()");break;case 3:await s("TrySkipPreviousAsync()");break;case 4:await sa(`Start-Process "${t}"`);break;case 5:throw new en("Setting volume on non premium account is not supported on Windows");case 6:throw new en("Setting position on non premium account is not supported on Windows");default:break}}async function pu(r,t=!1,n,s){let o=async c=>{s&&s>0&&(c=`
      delay ${s}
      ${c}
    `),t?await Xs(c):await jt(c)};switch(r){case 0:await o(tt("play"));break;case 1:await o(tt("pause"));break;case 2:await o(tt("next track"));break;case 3:await o(tt("previous track"));break;case 4:await o(tt(`play track "${n}"`));break;case 5:await o(tt(`set sound volume to ${n}`));break;case 6:await o(tt(`set player position to ${n}`));break;default:break}}var oa=require("@raycast/api");var mu="7bbb789c01ff44ed842907b7a80c404f",hu=["playlist-modify-private","playlist-modify-public","playlist-read-collaborative","playlist-read-private","user-follow-read","user-library-modify","user-library-read","user-modify-playback-state","user-read-currently-playing","user-read-playback-state","user-read-private","user-top-read"].join(" "),bu=new oa.OAuth.PKCEClient({redirectMethod:oa.OAuth.RedirectMethod.Web,providerName:"Spotify",providerIcon:"spotify-icon.svg",description:"Connect your Spotify account",providerId:"spotify"}),ia=new Kr({client:bu,clientId:mu,scope:hu,authorizeUrl:"https://accounts.spotify.com/authorize/",tokenUrl:"https://accounts.spotify.com/api/token",refreshTokenUrl:"https://accounts.spotify.com/api/token",bodyEncoding:"url-encoded"});var la={};Qn(la,{defaults:()=>nr,deleteMeAlbums:()=>ll,deleteMeAudiobooks:()=>Ju,deleteMeEpisodes:()=>gl,deleteMeFollowing:()=>Dl,deleteMeShows:()=>Ol,deleteMeTracks:()=>ml,deletePlaylistsByPlaylistIdFollowers:()=>Pl,deletePlaylistsByPlaylistIdTracks:()=>ol,getAlbums:()=>vu,getAlbumsById:()=>Tu,getAlbumsByIdTracks:()=>ju,getArtists:()=>Au,getArtistsById:()=>Cu,getArtistsByIdAlbums:()=>Iu,getArtistsByIdRelatedArtists:()=>Uu,getArtistsByIdTopTracks:()=>Mu,getAudioAnalysisById:()=>Fl,getAudioFeatures:()=>zl,getAudioFeaturesById:()=>Wl,getAudiobooks:()=>Fu,getAudiobooksById:()=>Wu,getAudiobooksByIdChapters:()=>Nu,getBrowseCategories:()=>vl,getBrowseCategoriesByCategoryId:()=>jl,getBrowseCategoriesByCategoryIdPlaylists:()=>Cl,getBrowseFeaturedPlaylists:()=>Tl,getBrowseNewReleases:()=>Ml,getChapters:()=>Yu,getChaptersById:()=>Gu,getEpisodes:()=>zu,getEpisodesById:()=>Bu,getMarkets:()=>id,getMe:()=>el,getMeAlbums:()=>cl,getMeAlbumsContains:()=>dl,getMeAudiobooks:()=>Qu,getMeAudiobooksContains:()=>Hu,getMeEpisodes:()=>bl,getMeEpisodesContains:()=>Sl,getMeFollowing:()=>Ul,getMeFollowingContains:()=>Ll,getMePlayer:()=>Vl,getMePlayerCurrentlyPlaying:()=>Gl,getMePlayerDevices:()=>Hl,getMePlayerQueue:()=>sd,getMePlayerRecentlyPlayed:()=>ad,getMePlaylists:()=>il,getMeShows:()=>wl,getMeShowsContains:()=>kl,getMeTopArtists:()=>cd,getMeTopTracks:()=>ud,getMeTracks:()=>fl,getMeTracksContains:()=>hl,getNext:()=>ld,getPlaylistsByPlaylistId:()=>tl,getPlaylistsByPlaylistIdFollowersContains:()=>Bl,getPlaylistsByPlaylistIdImages:()=>Al,getPlaylistsByPlaylistIdTracks:()=>nl,getRecommendations:()=>Nl,getRecommendationsAvailableGenreSeeds:()=>Ql,getShows:()=>Du,getShowsById:()=>qu,getShowsByIdEpisodes:()=>Lu,getTracks:()=>Zu,getTracksById:()=>Ku,getUsersByUserId:()=>El,getUsersByUserIdPlaylists:()=>Rl,postMePlayerNext:()=>Zl,postMePlayerPrevious:()=>Xl,postMePlayerQueue:()=>od,postPlaylistsByPlaylistIdTracks:()=>al,postUsersByUserIdPlaylists:()=>xl,putMeAlbums:()=>ul,putMeAudiobooks:()=>Vu,putMeEpisodes:()=>yl,putMeFollowing:()=>ql,putMePlayer:()=>Jl,putMePlayerPause:()=>Kl,putMePlayerPlay:()=>Yl,putMePlayerRepeat:()=>td,putMePlayerSeek:()=>ed,putMePlayerShuffle:()=>nd,putMePlayerVolume:()=>rd,putMeShows:()=>_l,putMeTracks:()=>pl,putPlaylistsByPlaylistId:()=>rl,putPlaylistsByPlaylistIdFollowers:()=>$l,putPlaylistsByPlaylistIdImages:()=>Il,putPlaylistsByPlaylistIdTracks:()=>sl,search:()=>Xu,servers:()=>so});var ao=X(no()),m=X(ua()),nr={baseUrl:"https://api.spotify.com/v1"},d=ao.runtime(nr),so={server1:"https://api.spotify.com/v1"};function Tu(r,{market:t}={},n){return d.ok(d.fetchJson(`/albums/${encodeURIComponent(r)}${m.query(m.explode({market:t}))}`,{...n}))}function vu(r,{market:t}={},n){return d.ok(d.fetchJson(`/albums${m.query(m.explode({ids:r,market:t}))}`,{...n}))}function ju(r,{market:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/albums/${encodeURIComponent(r)}/tracks${m.query(m.explode({market:t,limit:n,offset:s}))}`,{...o}))}function Cu(r,t){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}`,{...t}))}function Au(r,t){return d.ok(d.fetchJson(`/artists${m.query(m.explode({ids:r}))}`,{...t}))}function Iu(r,{includeGroups:t,market:n,limit:s,offset:o}={},c){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}/albums${m.query(m.explode({include_groups:t,market:n,limit:s,offset:o}))}`,{...c}))}function Mu(r,{market:t}={},n){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}/top-tracks${m.query(m.explode({market:t}))}`,{...n}))}function Uu(r,t){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}/related-artists`,{...t}))}function qu(r,{market:t}={},n){return d.ok(d.fetchJson(`/shows/${encodeURIComponent(r)}${m.query(m.explode({market:t}))}`,{...n}))}function Du(r,{market:t}={},n){return d.ok(d.fetchJson(`/shows${m.query(m.explode({market:t,ids:r}))}`,{...n}))}function Lu(r,{market:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/shows/${encodeURIComponent(r)}/episodes${m.query(m.explode({market:t,limit:n,offset:s}))}`,{...o}))}function Bu(r,{market:t}={},n){return d.ok(d.fetchJson(`/episodes/${encodeURIComponent(r)}${m.query(m.explode({market:t}))}`,{...n}))}function zu(r,{market:t}={},n){return d.ok(d.fetchJson(`/episodes${m.query(m.explode({ids:r,market:t}))}`,{...n}))}function Wu(r,{market:t}={},n){return d.ok(d.fetchJson(`/audiobooks/${encodeURIComponent(r)}${m.query(m.explode({market:t}))}`,{...n}))}function Fu(r,{market:t}={},n){return d.ok(d.fetchJson(`/audiobooks${m.query(m.explode({ids:r,market:t}))}`,{...n}))}function Nu(r,{market:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/audiobooks/${encodeURIComponent(r)}/chapters${m.query(m.explode({market:t,limit:n,offset:s}))}`,{...o}))}function Qu({limit:r,offset:t}={},n){return d.ok(d.fetchJson(`/me/audiobooks${m.query(m.explode({limit:r,offset:t}))}`,{...n}))}function Vu(r,t){return d.ok(d.fetchJson(`/me/audiobooks${m.query(m.explode({ids:r}))}`,{...t,method:"PUT"}))}function Ju(r,t){return d.ok(d.fetchJson(`/me/audiobooks${m.query(m.explode({ids:r}))}`,{...t,method:"DELETE"}))}function Hu(r,t){return d.ok(d.fetchJson(`/me/audiobooks/contains${m.query(m.explode({ids:r}))}`,{...t}))}function Gu(r,{market:t}={},n){return d.ok(d.fetchJson(`/chapters/${encodeURIComponent(r)}${m.query(m.explode({market:t}))}`,{...n}))}function Yu(r,{market:t}={},n){return d.ok(d.fetchJson(`/chapters${m.query(m.explode({ids:r,market:t}))}`,{...n}))}function Ku(r,{market:t}={},n){return d.ok(d.fetchJson(`/tracks/${encodeURIComponent(r)}${m.query(m.explode({market:t}))}`,{...n}))}function Zu(r,{market:t}={},n){return d.ok(d.fetchJson(`/tracks${m.query(m.explode({market:t,ids:r}))}`,{...n}))}function Xu(r,t,{market:n,limit:s,offset:o,includeExternal:c}={},l){return d.ok(d.fetchJson(`/search${m.query(m.explode({q:r,market:n,limit:s,offset:o,include_external:c}),m.form({type:t}))}`,{...l}))}function el(r){return d.ok(d.fetchJson("/me",{...r}))}function tl(r,{market:t,fields:n,additionalTypes:s}={},o){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}${m.query(m.explode({market:t,fields:n,additional_types:s}))}`,{...o}))}function rl(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}`,d.json({...n,method:"PUT",body:t})))}function nl(r,{market:t,fields:n,limit:s,offset:o,additionalTypes:c}={},l){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks${m.query(m.explode({market:t,fields:n,limit:s,offset:o,additional_types:c}))}`,{...l}))}function al(r,t,{position:n,uris:s}={},o){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks${m.query(m.explode({position:n,uris:s}))}`,d.json({...o,method:"POST",body:t})))}function sl(r,t,{uris:n}={},s){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks${m.query(m.explode({uris:n}))}`,d.json({...s,method:"PUT",body:t})))}function ol(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks`,d.json({...n,method:"DELETE",body:t})))}function il({limit:r,offset:t}={},n){return d.ok(d.fetchJson(`/me/playlists${m.query(m.explode({limit:r,offset:t}))}`,{...n}))}function cl({limit:r,offset:t,market:n}={},s){return d.ok(d.fetchJson(`/me/albums${m.query(m.explode({limit:r,offset:t,market:n}))}`,{...s}))}function ul(r,t,n){return d.ok(d.fetchJson(`/me/albums${m.query(m.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function ll(r,t,n){return d.ok(d.fetchJson(`/me/albums${m.query(m.explode({ids:r}))}`,d.json({...n,method:"DELETE",body:t})))}function dl(r,t){return d.ok(d.fetchJson(`/me/albums/contains${m.query(m.explode({ids:r}))}`,{...t}))}function fl({market:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/tracks${m.query(m.explode({market:r,limit:t,offset:n}))}`,{...s}))}function pl(r,t,n){return d.ok(d.fetchJson(`/me/tracks${m.query(m.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function ml(r,t,n){return d.ok(d.fetchJson(`/me/tracks${m.query(m.explode({ids:r}))}`,d.json({...n,method:"DELETE",body:t})))}function hl(r,t){return d.ok(d.fetchJson(`/me/tracks/contains${m.query(m.explode({ids:r}))}`,{...t}))}function bl({market:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/episodes${m.query(m.explode({market:r,limit:t,offset:n}))}`,{...s}))}function yl(r,t,n){return d.ok(d.fetchJson(`/me/episodes${m.query(m.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function gl(r,t,n){return d.ok(d.fetchJson(`/me/episodes${m.query(m.explode({ids:r}))}`,d.json({...n,method:"DELETE",body:t})))}function Sl(r,t){return d.ok(d.fetchJson(`/me/episodes/contains${m.query(m.explode({ids:r}))}`,{...t}))}function wl({limit:r,offset:t}={},n){return d.ok(d.fetchJson(`/me/shows${m.query(m.explode({limit:r,offset:t}))}`,{...n}))}function _l(r,t,n){return d.ok(d.fetchJson(`/me/shows${m.query(m.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function Ol(r,t,{market:n}={},s){return d.ok(d.fetchJson(`/me/shows${m.query(m.explode({ids:r,market:n}))}`,d.json({...s,method:"DELETE",body:t})))}function kl(r,t){return d.ok(d.fetchJson(`/me/shows/contains${m.query(m.explode({ids:r}))}`,{...t}))}function El(r,t){return d.ok(d.fetchJson(`/users/${encodeURIComponent(r)}`,{...t}))}function Rl(r,{limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/users/${encodeURIComponent(r)}/playlists${m.query(m.explode({limit:t,offset:n}))}`,{...s}))}function xl(r,t,n){return d.ok(d.fetchJson(`/users/${encodeURIComponent(r)}/playlists`,d.json({...n,method:"POST",body:t})))}function $l(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/followers`,d.json({...n,method:"PUT",body:t})))}function Pl(r,t){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/followers`,{...t,method:"DELETE"}))}function Tl({country:r,locale:t,timestamp:n,limit:s,offset:o}={},c){return d.ok(d.fetchJson(`/browse/featured-playlists${m.query(m.explode({country:r,locale:t,timestamp:n,limit:s,offset:o}))}`,{...c}))}function vl({country:r,locale:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/browse/categories${m.query(m.explode({country:r,locale:t,limit:n,offset:s}))}`,{...o}))}function jl(r,{country:t,locale:n}={},s){return d.ok(d.fetchJson(`/browse/categories/${encodeURIComponent(r)}${m.query(m.explode({country:t,locale:n}))}`,{...s}))}function Cl(r,{country:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/browse/categories/${encodeURIComponent(r)}/playlists${m.query(m.explode({country:t,limit:n,offset:s}))}`,{...o}))}function Al(r,t){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/images`,{...t}))}function Il(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/images`,{...n,method:"PUT",body:t}))}function Ml({country:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/browse/new-releases${m.query(m.explode({country:r,limit:t,offset:n}))}`,{...s}))}function Ul(r,{after:t,limit:n}={},s){return d.ok(d.fetchJson(`/me/following${m.query(m.explode({type:r,after:t,limit:n}))}`,{...s}))}function ql(r,t,n,s){return d.ok(d.fetchJson(`/me/following${m.query(m.explode({type:r,ids:t}))}`,d.json({...s,method:"PUT",body:n})))}function Dl(r,t,n,s){return d.ok(d.fetchJson(`/me/following${m.query(m.explode({type:r,ids:t}))}`,d.json({...s,method:"DELETE",body:n})))}function Ll(r,t,n){return d.ok(d.fetchJson(`/me/following/contains${m.query(m.explode({type:r,ids:t}))}`,{...n}))}function Bl(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/followers/contains${m.query(m.explode({ids:t}))}`,{...n}))}function zl(r,t){return d.ok(d.fetchJson(`/audio-features${m.query(m.explode({ids:r}))}`,{...t}))}function Wl(r,t){return d.ok(d.fetchJson(`/audio-features/${encodeURIComponent(r)}`,{...t}))}function Fl(r,t){return d.ok(d.fetchJson(`/audio-analysis/${encodeURIComponent(r)}`,{...t}))}function Nl({limit:r,market:t,seedArtists:n,seedGenres:s,seedTracks:o,minAcousticness:c,maxAcousticness:l,targetAcousticness:y,minDanceability:f,maxDanceability:b,targetDanceability:h,minDurationMs:k,maxDurationMs:_,targetDurationMs:E,minEnergy:O,maxEnergy:R,targetEnergy:P,minInstrumentalness:j,maxInstrumentalness:z,targetInstrumentalness:W,minKey:$,maxKey:L,targetKey:I,minLiveness:ne,maxLiveness:ee,targetLiveness:nt,minLoudness:Te,maxLoudness:Y,targetLoudness:J,minMode:ue,maxMode:ae,targetMode:U,minPopularity:se,maxPopularity:F,targetPopularity:K,minSpeechiness:te,maxSpeechiness:qe,targetSpeechiness:Je,minTempo:le,maxTempo:pe,targetTempo:bn,minTimeSignature:yn,maxTimeSignature:ve,targetTimeSignature:ge,minValence:gn,maxValence:pr,targetValence:je}={},Dt){return d.ok(d.fetchJson(`/recommendations${m.query(m.explode({limit:r,market:t,seed_artists:n,seed_genres:s,seed_tracks:o,min_acousticness:c,max_acousticness:l,target_acousticness:y,min_danceability:f,max_danceability:b,target_danceability:h,min_duration_ms:k,max_duration_ms:_,target_duration_ms:E,min_energy:O,max_energy:R,target_energy:P,min_instrumentalness:j,max_instrumentalness:z,target_instrumentalness:W,min_key:$,max_key:L,target_key:I,min_liveness:ne,max_liveness:ee,target_liveness:nt,min_loudness:Te,max_loudness:Y,target_loudness:J,min_mode:ue,max_mode:ae,target_mode:U,min_popularity:se,max_popularity:F,target_popularity:K,min_speechiness:te,max_speechiness:qe,target_speechiness:Je,min_tempo:le,max_tempo:pe,target_tempo:bn,min_time_signature:yn,max_time_signature:ve,target_time_signature:ge,min_valence:gn,max_valence:pr,target_valence:je}))}`,{...Dt}))}function Ql(r){return d.ok(d.fetchJson("/recommendations/available-genre-seeds",{...r}))}function Vl({market:r,additionalTypes:t}={},n){return d.ok(d.fetchJson(`/me/player${m.query(m.explode({market:r,additional_types:t}))}`,{...n}))}function Jl(r,t){return d.ok(d.fetchJson("/me/player",d.json({...t,method:"PUT",body:r})))}function Hl(r){return d.ok(d.fetchJson("/me/player/devices",{...r}))}function Gl({market:r,additionalTypes:t}={},n){return d.ok(d.fetchJson(`/me/player/currently-playing${m.query(m.explode({market:r,additional_types:t}))}`,{...n}))}function Yl(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/play${m.query(m.explode({device_id:t}))}`,d.json({...n,method:"PUT",body:r})))}function Kl({deviceId:r}={},t){return d.ok(d.fetchJson(`/me/player/pause${m.query(m.explode({device_id:r}))}`,{...t,method:"PUT"}))}function Zl({deviceId:r}={},t){return d.ok(d.fetchJson(`/me/player/next${m.query(m.explode({device_id:r}))}`,{...t,method:"POST"}))}function Xl({deviceId:r}={},t){return d.ok(d.fetchJson(`/me/player/previous${m.query(m.explode({device_id:r}))}`,{...t,method:"POST"}))}function ed(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/seek${m.query(m.explode({position_ms:r,device_id:t}))}`,{...n,method:"PUT"}))}function td(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/repeat${m.query(m.explode({state:r,device_id:t}))}`,{...n,method:"PUT"}))}function rd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/volume${m.query(m.explode({volume_percent:r,device_id:t}))}`,{...n,method:"PUT"}))}function nd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/shuffle${m.query(m.explode({state:r,device_id:t}))}`,{...n,method:"PUT"}))}function ad({limit:r,after:t,before:n}={},s){return d.ok(d.fetchJson(`/me/player/recently-played${m.query(m.explode({limit:r,after:t,before:n}))}`,{...s}))}function sd(r){return d.ok(d.fetchJson("/me/player/queue",{...r}))}function od(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/queue${m.query(m.explode({uri:r,device_id:t}))}`,{...n,method:"POST"}))}function id(r){return d.ok(d.fetchJson("/markets",{...r}))}function cd({timeRange:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/top/artists${m.query(m.explode({time_range:r,limit:t,offset:n}))}`,{...s}))}function ud({timeRange:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/top/tracks${m.query(m.explode({time_range:r,limit:t,offset:n}))}`,{...s}))}function ld(r,t){let n=r.replace(so.server1,"");return d.ok(d.fetchJson(n,{...t}))}var Do=X(require("node:http"),1),Lo=X(require("node:https"),1),ht=X(require("node:zlib"),1),Oe=X(require("node:stream"),1),lr=require("node:buffer");function dd(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let t=r.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let n=r.substring(5,t).split(";"),s="",o=!1,c=n[0]||"text/plain",l=c;for(let h=1;h<n.length;h++)n[h]==="base64"?o=!0:n[h]&&(l+=`;${n[h]}`,n[h].indexOf("charset=")===0&&(s=n[h].substring(8)));!n[0]&&!s.length&&(l+=";charset=US-ASCII",s="US-ASCII");let y=o?"base64":"ascii",f=unescape(r.substring(t+1)),b=Buffer.from(f,y);return b.type=c,b.typeFull=l,b.charset=s,b}var oo=dd;var xe=X(require("node:stream"),1),Ve=require("node:util"),we=require("node:buffer");ar();an();var Qe=class extends Error{constructor(t,n){super(t),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var be=class extends Qe{constructor(t,n,s){super(t,n),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var sn=Symbol.toStringTag,ha=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[sn]==="URLSearchParams",or=r=>r&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[sn]),bo=r=>typeof r=="object"&&(r[sn]==="AbortSignal"||r[sn]==="EventTarget"),yo=(r,t)=>{let n=new URL(t).hostname,s=new URL(r).hostname;return n===s||n.endsWith(`.${s}`)},go=(r,t)=>{let n=new URL(t).protocol,s=new URL(r).protocol;return n===s};var xd=(0,Ve.promisify)(xe.default.pipeline),ye=Symbol("Body internals"),ze=class{constructor(t,{size:n=0}={}){let s=null;t===null?t=null:ha(t)?t=we.Buffer.from(t.toString()):or(t)||we.Buffer.isBuffer(t)||(Ve.types.isAnyArrayBuffer(t)?t=we.Buffer.from(t):ArrayBuffer.isView(t)?t=we.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof xe.default||(t instanceof ft?(t=ho(t),s=t.type.split("=")[1]):t=we.Buffer.from(String(t))));let o=t;we.Buffer.isBuffer(t)?o=xe.default.Readable.from(t):or(t)&&(o=xe.default.Readable.from(t.stream())),this[ye]={body:t,stream:o,boundary:s,disturbed:!1,error:null},this.size=n,t instanceof xe.default&&t.on("error",c=>{let l=c instanceof Qe?c:new be(`Invalid response body while trying to fetch ${this.url}: ${c.message}`,"system",c);this[ye].error=l})}get body(){return this[ye].stream}get bodyUsed(){return this[ye].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:n,byteLength:s}=await ga(this);return t.slice(n,n+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new ft,o=new URLSearchParams(await this.text());for(let[c,l]of o)s.append(c,l);return s}let{toFormData:n}=await Promise.resolve().then(()=>(ko(),Oo));return n(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[ye].body&&this[ye].body.type||"",n=await this.arrayBuffer();return new Ne([n],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await ga(this);return new TextDecoder().decode(t)}buffer(){return ga(this)}};ze.prototype.buffer=(0,Ve.deprecate)(ze.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ze.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,Ve.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function ga(r){if(r[ye].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[ye].disturbed=!0,r[ye].error)throw r[ye].error;let{body:t}=r;if(t===null)return we.Buffer.alloc(0);if(!(t instanceof xe.default))return we.Buffer.alloc(0);let n=[],s=0;try{for await(let o of t){if(r.size>0&&s+o.length>r.size){let c=new be(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw t.destroy(c),c}s+=o.length,n.push(o)}}catch(o){throw o instanceof Qe?o:new be(`Invalid response body while trying to fetch ${r.url}: ${o.message}`,"system",o)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return n.every(o=>typeof o=="string")?we.Buffer.from(n.join("")):we.Buffer.concat(n,s)}catch(o){throw new be(`Could not create Buffer from response body for ${r.url}: ${o.message}`,"system",o)}else throw new be(`Premature close of server response while trying to fetch ${r.url}`)}var At=(r,t)=>{let n,s,{body:o}=r[ye];if(r.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof xe.default&&typeof o.getBoundary!="function"&&(n=new xe.PassThrough({highWaterMark:t}),s=new xe.PassThrough({highWaterMark:t}),o.pipe(n),o.pipe(s),r[ye].stream=n,o=s),o},$d=(0,Ve.deprecate)(r=>r.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),ln=(r,t)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":ha(r)?"application/x-www-form-urlencoded;charset=UTF-8":or(r)?r.type||null:we.Buffer.isBuffer(r)||Ve.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r instanceof ft?`multipart/form-data; boundary=${t[ye].boundary}`:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${$d(r)}`:r instanceof xe.default?null:"text/plain;charset=UTF-8",Eo=r=>{let{body:t}=r[ye];return t===null?0:or(t)?t.size:we.Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Ro=async(r,{body:t})=>{t===null?r.end():await xd(t,r)};var Sa=require("node:util"),cr=X(require("node:http"),1),dn=typeof cr.default.validateHeaderName=="function"?cr.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let t=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},wa=typeof cr.default.validateHeaderValue=="function"?cr.default.validateHeaderValue:(r,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let n=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},_e=class r extends URLSearchParams{constructor(t){let n=[];if(t instanceof r){let s=t.raw();for(let[o,c]of Object.entries(s))n.push(...c.map(l=>[o,l]))}else if(t!=null)if(typeof t=="object"&&!Sa.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)n.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");n=[...t].map(o=>{if(typeof o!="object"||Sa.types.isBoxedPrimitive(o))throw new TypeError("Each header pair must be an iterable object");return[...o]}).map(o=>{if(o.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...o]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([s,o])=>(dn(s),wa(s,String(o)),[String(s).toLowerCase(),String(o)])):void 0,super(n),new Proxy(this,{get(s,o,c){switch(o){case"append":case"set":return(l,y)=>(dn(l),wa(l,String(y)),URLSearchParams.prototype[o].call(s,String(l).toLowerCase(),String(y)));case"delete":case"has":case"getAll":return l=>(dn(l),URLSearchParams.prototype[o].call(s,String(l).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,o,c)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let n=this.getAll(t);if(n.length===0)return null;let s=n.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,n=void 0){for(let s of this.keys())Reflect.apply(t,n,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,n)=>(t[n]=this.getAll(n),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,n)=>{let s=this.getAll(n);return n==="host"?t[n]=s[0]:t[n]=s.length>1?s:s[0],t},{})}};Object.defineProperties(_e.prototype,["get","entries","forEach","values"].reduce((r,t)=>(r[t]={enumerable:!0},r),{}));function xo(r=[]){return new _e(r.reduce((t,n,s,o)=>(s%2===0&&t.push(o.slice(s,s+2)),t),[]).filter(([t,n])=>{try{return dn(t),wa(t,String(n)),!0}catch{return!1}}))}var Pd=new Set([301,302,303,307,308]),fn=r=>Pd.has(r);var Ue=Symbol("Response internals"),$e=class r extends ze{constructor(t=null,n={}){super(t,n);let s=n.status!=null?n.status:200,o=new _e(n.headers);if(t!==null&&!o.has("Content-Type")){let c=ln(t,this);c&&o.append("Content-Type",c)}this[Ue]={type:"default",url:n.url,status:s,statusText:n.statusText||"",headers:o,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[Ue].type}get url(){return this[Ue].url||""}get status(){return this[Ue].status}get ok(){return this[Ue].status>=200&&this[Ue].status<300}get redirected(){return this[Ue].counter>0}get statusText(){return this[Ue].statusText}get headers(){return this[Ue].headers}get highWaterMark(){return this[Ue].highWaterMark}clone(){return new r(At(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,n=302){if(!fn(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new r(null,{headers:{location:new URL(t).toString()},status:n})}static error(){let t=new r(null,{status:0,statusText:""});return t[Ue].type="error",t}static json(t=void 0,n={}){let s=JSON.stringify(t);if(s===void 0)throw new TypeError("data is not JSON serializable");let o=new _e(n&&n.headers);return o.has("content-type")||o.set("content-type","application/json"),new r(s,{...n,headers:o})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties($e.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Mo=require("node:url"),Uo=require("node:util");var $o=r=>{if(r.search)return r.search;let t=r.href.length-1,n=r.hash||(r.href[t]==="#"?"#":"");return r.href[t-n.length]==="?"?"?":""};var To=require("node:net");function Po(r,t=!1){return r==null||(r=new URL(r),/^(about|blob|data):$/.test(r.protocol))?"no-referrer":(r.username="",r.password="",r.hash="",t&&(r.pathname="",r.search=""),r)}var vo=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),jo="strict-origin-when-cross-origin";function Co(r){if(!vo.has(r))throw new TypeError(`Invalid referrerPolicy: ${r}`);return r}function Td(r){if(/^(http|ws)s:$/.test(r.protocol))return!0;let t=r.host.replace(/(^\[)|(]$)/g,""),n=(0,To.isIP)(t);return n===4&&/^127\./.test(t)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:r.host==="localhost"||r.host.endsWith(".localhost")?!1:r.protocol==="file:"}function It(r){return/^about:(blank|srcdoc)$/.test(r)||r.protocol==="data:"||/^(blob|filesystem):$/.test(r.protocol)?!0:Td(r)}function Ao(r,{referrerURLCallback:t,referrerOriginCallback:n}={}){if(r.referrer==="no-referrer"||r.referrerPolicy==="")return null;let s=r.referrerPolicy;if(r.referrer==="about:client")return"no-referrer";let o=r.referrer,c=Po(o),l=Po(o,!0);c.toString().length>4096&&(c=l),t&&(c=t(c)),n&&(l=n(l));let y=new URL(r.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return l;case"unsafe-url":return c;case"strict-origin":return It(c)&&!It(y)?"no-referrer":l.toString();case"strict-origin-when-cross-origin":return c.origin===y.origin?c:It(c)&&!It(y)?"no-referrer":l;case"same-origin":return c.origin===y.origin?c:"no-referrer";case"origin-when-cross-origin":return c.origin===y.origin?c:l;case"no-referrer-when-downgrade":return It(c)&&!It(y)?"no-referrer":c;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Io(r){let t=(r.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let s of t)s&&vo.has(s)&&(n=s);return n}var re=Symbol("Request internals"),ur=r=>typeof r=="object"&&typeof r[re]=="object",vd=(0,Uo.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),mt=class r extends ze{constructor(t,n={}){let s;if(ur(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let o=n.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(o)&&(o=o.toUpperCase()),!ur(n)&&"data"in n&&vd(),(n.body!=null||ur(t)&&t.body!==null)&&(o==="GET"||o==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let c=n.body?n.body:ur(t)&&t.body!==null?At(t):null;super(c,{size:n.size||t.size||0});let l=new _e(n.headers||t.headers||{});if(c!==null&&!l.has("Content-Type")){let b=ln(c,this);b&&l.set("Content-Type",b)}let y=ur(t)?t.signal:null;if("signal"in n&&(y=n.signal),y!=null&&!bo(y))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let f=n.referrer==null?t.referrer:n.referrer;if(f==="")f="no-referrer";else if(f){let b=new URL(f);f=/^about:(\/\/)?client$/.test(b)?"client":b}else f=void 0;this[re]={method:o,redirect:n.redirect||t.redirect||"follow",headers:l,parsedURL:s,signal:y,referrer:f},this.follow=n.follow===void 0?t.follow===void 0?20:t.follow:n.follow,this.compress=n.compress===void 0?t.compress===void 0?!0:t.compress:n.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent,this.highWaterMark=n.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||t.referrerPolicy||""}get method(){return this[re].method}get url(){return(0,Mo.format)(this[re].parsedURL)}get headers(){return this[re].headers}get redirect(){return this[re].redirect}get signal(){return this[re].signal}get referrer(){if(this[re].referrer==="no-referrer")return"";if(this[re].referrer==="client")return"about:client";if(this[re].referrer)return this[re].referrer.toString()}get referrerPolicy(){return this[re].referrerPolicy}set referrerPolicy(t){this[re].referrerPolicy=Co(t)}clone(){return new r(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(mt.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var qo=r=>{let{parsedURL:t}=r[re],n=new _e(r[re].headers);n.has("Accept")||n.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let y=Eo(r);typeof y=="number"&&!Number.isNaN(y)&&(s=String(y))}s&&n.set("Content-Length",s),r.referrerPolicy===""&&(r.referrerPolicy=jo),r.referrer&&r.referrer!=="no-referrer"?r[re].referrer=Ao(r):r[re].referrer="no-referrer",r[re].referrer instanceof URL&&n.set("Referer",r.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),r.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=r;typeof o=="function"&&(o=o(t));let c=$o(t),l={path:t.pathname+c,method:r.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:o};return{parsedURL:t,options:l}};var pn=class extends Qe{constructor(t,n="aborted"){super(t,n)}};an();ba();var jd=new Set(["data:","http:","https:"]);async function mn(r,t){return new Promise((n,s)=>{let o=new mt(r,t),{parsedURL:c,options:l}=qo(o);if(!jd.has(c.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${c.protocol.replace(/:$/,"")}" is not supported.`);if(c.protocol==="data:"){let O=oo(o.url),R=new $e(O,{headers:{"Content-Type":O.typeFull}});n(R);return}let y=(c.protocol==="https:"?Lo.default:Do.default).request,{signal:f}=o,b=null,h=()=>{let O=new pn("The operation was aborted.");s(O),o.body&&o.body instanceof Oe.default.Readable&&o.body.destroy(O),!(!b||!b.body)&&b.body.emit("error",O)};if(f&&f.aborted){h();return}let k=()=>{h(),E()},_=y(c.toString(),l);f&&f.addEventListener("abort",k);let E=()=>{_.abort(),f&&f.removeEventListener("abort",k)};_.on("error",O=>{s(new be(`request to ${o.url} failed, reason: ${O.message}`,"system",O)),E()}),Cd(_,O=>{b&&b.body&&b.body.destroy(O)}),process.version<"v14"&&_.on("socket",O=>{let R;O.prependListener("end",()=>{R=O._eventsCount}),O.prependListener("close",P=>{if(b&&R<O._eventsCount&&!P){let j=new Error("Premature close");j.code="ERR_STREAM_PREMATURE_CLOSE",b.body.emit("error",j)}})}),_.on("response",O=>{_.setTimeout(0);let R=xo(O.rawHeaders);if(fn(O.statusCode)){let $=R.get("Location"),L=null;try{L=$===null?null:new URL($,o.url)}catch{if(o.redirect!=="manual"){s(new be(`uri requested responds with an invalid redirect URL: ${$}`,"invalid-redirect")),E();return}}switch(o.redirect){case"error":s(new be(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),E();return;case"manual":break;case"follow":{if(L===null)break;if(o.counter>=o.follow){s(new be(`maximum redirect reached at: ${o.url}`,"max-redirect")),E();return}let I={headers:new _e(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:At(o),signal:o.signal,size:o.size,referrer:o.referrer,referrerPolicy:o.referrerPolicy};if(!yo(o.url,L)||!go(o.url,L))for(let ee of["authorization","www-authenticate","cookie","cookie2"])I.headers.delete(ee);if(O.statusCode!==303&&o.body&&t.body instanceof Oe.default.Readable){s(new be("Cannot follow redirect with body being a readable stream","unsupported-redirect")),E();return}(O.statusCode===303||(O.statusCode===301||O.statusCode===302)&&o.method==="POST")&&(I.method="GET",I.body=void 0,I.headers.delete("content-length"));let ne=Io(R);ne&&(I.referrerPolicy=ne),n(mn(new mt(L,I))),E();return}default:return s(new TypeError(`Redirect option '${o.redirect}' is not a valid value of RequestRedirect`))}}f&&O.once("end",()=>{f.removeEventListener("abort",k)});let P=(0,Oe.pipeline)(O,new Oe.PassThrough,$=>{$&&s($)});process.version<"v12.10"&&O.on("aborted",k);let j={url:o.url,status:O.statusCode,statusText:O.statusMessage,headers:R,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},z=R.get("Content-Encoding");if(!o.compress||o.method==="HEAD"||z===null||O.statusCode===204||O.statusCode===304){b=new $e(P,j),n(b);return}let W={flush:ht.default.Z_SYNC_FLUSH,finishFlush:ht.default.Z_SYNC_FLUSH};if(z==="gzip"||z==="x-gzip"){P=(0,Oe.pipeline)(P,ht.default.createGunzip(W),$=>{$&&s($)}),b=new $e(P,j),n(b);return}if(z==="deflate"||z==="x-deflate"){let $=(0,Oe.pipeline)(O,new Oe.PassThrough,L=>{L&&s(L)});$.once("data",L=>{(L[0]&15)===8?P=(0,Oe.pipeline)(P,ht.default.createInflate(),I=>{I&&s(I)}):P=(0,Oe.pipeline)(P,ht.default.createInflateRaw(),I=>{I&&s(I)}),b=new $e(P,j),n(b)}),$.once("end",()=>{b||(b=new $e(P,j),n(b))});return}if(z==="br"){P=(0,Oe.pipeline)(P,ht.default.createBrotliDecompress(),$=>{$&&s($)}),b=new $e(P,j),n(b);return}b=new $e(P,j),n(b)}),Ro(_,o).catch(s)})}function Cd(r,t){let n=lr.Buffer.from(`0\r
\r
`),s=!1,o=!1,c;r.on("response",l=>{let{headers:y}=l;s=y["transfer-encoding"]==="chunked"&&!y["content-length"]}),r.on("socket",l=>{let y=()=>{if(s&&!o){let b=new Error("Premature close");b.code="ERR_STREAM_PREMATURE_CLOSE",t(b)}},f=b=>{o=lr.Buffer.compare(b.slice(-5),n)===0,!o&&c&&(o=lr.Buffer.compare(c.slice(-3),n.slice(0,3))===0&&lr.Buffer.compare(b.slice(-2),n.slice(3))===0),c=b};l.prependListener("close",y),l.on("data",f),r.on("close",()=>{l.removeListener("close",y),l.removeListener("data",f)})})}var _a;ia.onAuthorize=({token:r})=>{nr.headers={Authorization:`Bearer ${r}`},nr.fetch=mn,_a=la};var Bo=Js(ia);function V(){if(!_a)throw new Error("getSpotifyClient must be used when authenticated");return{spotifyClient:_a}}async function zo(){let{spotifyClient:r}=V();try{await r.putMePlayerPause()}catch(t){let n=C(t);if(n?.toLocaleLowerCase().includes("restricted device")||n?.toLocaleLowerCase().includes("premium required")){await ie(1);return}throw console.log("pause.ts Error: ",n),new Error(n)}}var Ko=X(Xr());var Wo=require("@raycast/api"),Mt=!1;async function Ut(){return Mt=!!(await(0,Wo.getApplications)()).find(n=>n.bundleId?n.bundleId==="com.spotify.client":n.name==="Spotify"),Mt}async function fr(){let{spotifyClient:r}=V();try{return await r.getMePlayerDevices()}catch(t){let n=C(t);throw console.log("getMyDevices.ts Error:",n),new Error(n)}}var Zo=X(Go()),qt={album:"spotify:album:",artist:"spotify:artist:",playlist:"spotify:playlist:",track:"spotify:track:",show:"spotify:show:",episode:"spotify:episode:"};async function Xo({id:r,type:t,contextUri:n,uris:s}={}){let{spotifyClient:o}=V(),{devices:c}=await fr(),l=await Ut();try{let y=c?.find(b=>b.is_active);if(!y&&l)if(s&&s.length>0){await ie(1,!1),await(0,Zo.default)(async b=>{try{console.warn("Trying to play via Web API.");let{devices:h}=await fr(),_=h?.find(E=>E.is_active)?.id??h?.[0]?.id??void 0;await o.putMePlayerPlay({uris:s},{deviceId:_})}catch(h){if(h instanceof Ko.HttpError){let _=JSON.parse(h.data)?.error?.message;if(_&&_.toLowerCase().includes("no active device"))throw h}return b(h)}},{retries:5,minTimeout:1e3});return}else return Yo({id:r,type:t});let f=y?.id??c?.[0]?.id??void 0;if(s&&s.length>0){await o.putMePlayerPlay({uris:s},{deviceId:f});return}!t||!r?await o.putMePlayerPlay({context_uri:n},{deviceId:f}):t==="track"?n?await o.putMePlayerPlay({context_uri:n,offset:{uri:`${qt.track}${r}`}},{deviceId:f}):await o.putMePlayerPlay({uris:[`${qt.track}${r}`]},{deviceId:f}):t==="episode"?await o.putMePlayerPlay({uris:[`${qt.episode}${r}`]},{deviceId:f}):await o.putMePlayerPlay({context_uri:`${qt[t]}${r}`},{deviceId:f})}catch(y){let f=C(y);if(l&&(f?.toLocaleLowerCase().includes("no device found")||f?.toLocaleLowerCase().includes("no active device")||f?.toLocaleLowerCase().includes("restricted device")||f?.toLocaleLowerCase().includes("premium required"))){await Yo({id:r,type:t});return}throw new Error(f)}}async function Yo({id:r,type:t}){try{!t||!r?await ie(0):t==="track"?await ie(4,!1,`${qt[t]}${r}`):await ie(4,!1,`${qt[t]}${r}`,1)}catch(n){let s=C(n);throw new Error(s)}}function hn(r){return new Promise(t=>setTimeout(t,r))}async function ei(){let{spotifyClient:r}=V();try{await r.postMePlayerNext(),await hn(100)}catch(t){let n=C(t);if(n?.toLocaleLowerCase().includes("restricted device")||n?.toLocaleLowerCase().includes("premium required")){await ie(2);return}throw console.log("skipToNext.ts Error:",n),new Error(n)}}async function ti(){let{spotifyClient:r}=V();try{await r.postMePlayerPrevious(),await hn(100)}catch(t){let n=C(t);if(n?.toLocaleLowerCase().includes("restricted device")||n?.toLocaleLowerCase().includes("premium required")){await ie(3);return}throw console.log("skipToPrevious.ts Error:",n),new Error(n)}}async function ri({trackIds:r,artistIds:t}){let{spotifyClient:n}=V();try{return await n.getRecommendations({seedTracks:r.join(),seedArtists:t?.join()})}catch(s){let o=C(s);throw console.log("getRecommendations.ts Error:",o),new Error(o)}}async function ni({trackIds:r=[],artistIds:t=[]}={}){let{spotifyClient:n}=V();try{let o=(await ri({trackIds:r,artistIds:t}))?.tracks;if(o)try{await n.putMePlayerPlay({uris:o.flatMap(c=>c.uri)})}catch(c){let l=C(c);(l?.toLocaleLowerCase().includes("no active device")||l?.toLocaleLowerCase().includes("restricted device")||l?.toLocaleLowerCase().includes("premium required"))&&await ie(4,!0,o[0].uri)}}catch(s){let o=C(s);throw console.log("startRadio.ts Error:",o),new Error(o)}}async function ai({trackIds:r}){let{spotifyClient:t}=V();try{return await t.deleteMeTracks(r.join())}catch(n){let s=C(n);throw console.log("removeFromMySavedTracks.ts Error:",s),new Error(s)}}async function si({trackIds:r}){let{spotifyClient:t}=V();try{return await t.putMeTracks(r.join())}catch(n){let s=C(n);throw console.log("addToMySavedTracks.ts Error:",s),new Error(s)}}async function oi(r,t){let{spotifyClient:n}=V();try{return await n.putMePlayer({device_ids:[r],play:t})}catch(s){let o=C(s);throw console.log("transferMyPlayback.ts Error:",o),new Error(o)}}async function ii(){let{spotifyClient:r}=V();try{let t=await r.getMePlayerCurrentlyPlaying({additionalTypes:"episode"});return t?{...t,item:t.item}:void 0}catch(t){let n=C(t);throw console.log("getCurrentlyPlaying.ts Error:",n),new Error(n)}}function ci({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Re(()=>ii(),[],{execute:r?.execute!==!1});return{currentlyPlayingData:t,currentlyPlayingError:n,currentlyPlayingIsLoading:s,currentlyPlayingRevalidate:o}}function ui({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Re(()=>fr(),[],{execute:r?.execute!==!1});return{myDevicesData:t,myDevicesError:n,myDevicesIsLoading:s,myDevicesRevalidate:o}}var li=require("react");var di=Bo(({children:r})=>((0,li.useEffect)(()=>{Ut()},[]),r));async function fi({limit:r=50}={}){let{spotifyClient:t}=V(),n=null,s=null;try{for(n=await t.getMePlaylists({limit:r}),s=n?.next;s;){let o=await t.getNext(s);n={...n,...o,items:[...n?.items??[],...o.items??[]]},s=o?.next}return n}catch(o){let c=C(o);throw console.log("getMyPlaylists.ts Error:",c),new Error(c)}}function pi({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Re(()=>fi(),[],{execute:r?.execute!==!1});return{myPlaylistsData:t,myPlaylistsError:n,myPlaylistsIsLoading:s,myPlaylistsRevalidate:o}}async function mi({playlistId:r,trackUris:t}){let{spotifyClient:n}=V();try{return await n.postPlaylistsByPlaylistIdTracks(r,{uris:t})}catch(s){let o=C(s);throw console.log("addToPlaylist.ts Error:",o),new Error(o)}}async function hi({trackIds:r}){let{spotifyClient:t}=V();try{return await t.getMeTracksContains(r.join())}catch(n){let s=C(n);throw console.log("containsMySavedTracks.ts Error:",s),new Error(s)}}function bi({trackIds:r,options:t}){let{data:n,error:s,isLoading:o,revalidate:c}=Re(l=>hi({trackIds:l}),[r],{execute:t?.execute!==!1&&r.length>0});return{containsMySavedTracksData:n,containsMySavedTracksError:s,containsMySavedTracksIsLoading:o,containsMySavedTracksRevalidate:c}}async function yi(){let{spotifyClient:r}=V();try{return await r.getMe()}catch(t){let n=C(t);throw console.log("getMe.ts Error:",n),new Error(n)}}function gi({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Re(()=>yi(),[],{execute:r?.execute!==!1});return{meData:t,meError:n,meIsLoading:s,meRevalidate:o}}function Ud(r){let t=r.toLowerCase().trim();if(r.charAt(0)==="("||r.charAt(0)==="["||t.startsWith("feat.")||t.startsWith("ft.")||t.startsWith("featuring"))return r;let n=r.indexOf("("),s=r.indexOf("["),o=r.indexOf(" - "),c=r.match(/(\s+|\()(feat\.|ft\.|featuring)(\s|\))/i),l=c?c.index:-1,y=Math.min(n!==-1?n:1/0,s!==-1?s:1/0,o!==-1?o:1/0,l!==-1?l:1/0);return y!==1/0?r.slice(0,y).trim():r}var Si=Ud;function Oa({name:r,artistName:t,hideArtistName:n,maxTextLength:s,cleanupTitle:o}){let c=s?Number(s):30;if(c===0||!r||!t)return"";let l=o?Si(r):r,y=n?l:`${l} \xB7 ${t}`;return y.length<=c?y:y.substring(0,c).trim()+"\u2026"}async function wi(){if(await Ut()){let n=await jt(`
    if application "Spotify" is not running then
        return "Not running"
    end if
  
    property currentUri : "Unknown URI"
    property playerState : "stopped"
  
    tell application "Spotify"
        try
            set currentUri to id of the current track
            set playerState to player state as string
        end try
    end tell
  
    if playerState is "playing" then
        return currentUri
    else if playerState is "paused" then
        return currentUri & "(paused)"
    else
        return "Not playing"
    end if`);if(n==="Not running")return{state:"NOT_RUNNING",uri:void 0};if(n==="Not playing")return{state:"NOT_PLAYING",uri:void 0};{let s=n.includes("(paused)")?"PAUSED":"PLAYING",o=n.replace(" (paused)","");return{state:s,uri:o}}}}function _i({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Re(()=>wi(),[],{execute:r?.execute!==!1});return{spotifyAppData:t,spotifyAppDataError:n,spotifyAppDataIsLoading:s,spotifyAppDataRevalidate:o}}async function ka(r){let{spotifyClient:t}=V(),n=!1;try{let s=await t.getMePlayerCurrentlyPlaying({additionalTypes:"episode"});if(s){let o=s.item;return o.duration_ms&&r*1e3>o.duration_ms?(n=!0,await t.postMePlayerNext(),"next"):(await t.putMePlayerSeek(r*1e3),"position")}return"error"}catch(s){let o=C(s);if(o?.toLocaleLowerCase().includes("restricted device")||o?.toLocaleLowerCase().includes("premium required"))return n?(await ie(2),"next"):(await ie(6,!1,r),"position");throw console.log("seek.ts Error:",o),new Error(o)}}var v=require("react/jsx-runtime");function qd({launchType:r}){let{hideArtistName:t,maxTextLength:n,iconType:s,cleanupTitle:o}=(0,S.getPreferenceValues)(),[c,l]=aa("currentlyPlayingUri",void 0),{spotifyAppData:y,spotifyAppDataIsLoading:f,spotifyAppDataRevalidate:b}=_i(),h=y?.state!=="NOT_RUNNING"&&y?.state!=="NOT_PLAYING",k=h&&c!==y?.uri,{currentlyPlayingData:_,currentlyPlayingIsLoading:E,currentlyPlayingRevalidate:O}=ci({options:{execute:h&&(k||!!c)}}),{myDevicesData:R}=ui({options:{execute:r===S.LaunchType.UserInitiated}}),{myPlaylistsData:P}=pi({options:{execute:r===S.LaunchType.UserInitiated}}),{meData:j}=gi({options:{execute:r===S.LaunchType.UserInitiated}}),{containsMySavedTracksData:z,containsMySavedTracksRevalidate:W}=bi({trackIds:_?.item?.id?[_?.item?.id]:[],options:{execute:r===S.LaunchType.UserInitiated}});if(Oi.default.useEffect(()=>{if(!h){c!==void 0&&l(void 0);return}c!==y?.uri&&l(y?.uri)},[h,y?.uri,c,l]),f||E)return(0,v.jsx)(S.MenuBarExtra,{isLoading:!0});if(!h)return(0,v.jsx)(Dd,{isLoading:!1});let $=y?.state==="PLAYING",L=z?.[0],I=_?.currently_playing_type!=="episode",ne=Date.now(),ee=7200*1e3;if(_?.timestamp&&ne-_.timestamp>ee&&!$||!_?.item)return(0,v.jsx)(Ld,{isLoading:f||E||E});let{item:Te}=_,{name:Y,external_urls:J,uri:ue}=Te,ae="",U="",se=null;if(I){let{artists:F,id:K,album:te}=Te,qe=F?.[0]?.name,Je=F?.[0]?.id;ae=Oa({name:Y,artistName:qe,hideArtistName:t,maxTextLength:n,cleanupTitle:o}),U=te?.images.slice(-1)[0]?.url||"",se=(0,v.jsxs)(v.Fragment,{children:[L&&(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.HeartDisabled,title:"Dislike",onAction:async()=>{try{await ai({trackIds:K?[K]:[]}),await W()}catch(le){let pe=C(le);(0,S.showHUD)(pe)}}}),!L&&(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.Heart,title:"Like",onAction:async()=>{try{await si({trackIds:K?[K]:[]}),await W()}catch(le){let pe=C(le);(0,S.showHUD)(pe)}}}),(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.Forward,title:"Next",onAction:async()=>{try{await ei(),await O()}catch(le){let pe=C(le);(0,S.showHUD)(pe)}}}),(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.Rewind,title:"Previous",onAction:async()=>{try{await ti(),await O()}catch(le){let pe=C(le);(0,S.showHUD)(pe)}}}),(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.Music,title:"Start Radio",onAction:async()=>{try{await ni({trackIds:K?[K]:[],artistIds:Je?[Je]:[]})}catch(le){let pe=C(le);(0,S.showHUD)(pe)}}})]})}else{let{show:F}=Te,K=F.name;ae=Oa({name:Y,artistName:K,hideArtistName:t,maxTextLength:n,cleanupTitle:o}),U=F.images.slice(-1)[0]?.url||"",se=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.RotateClockwise,title:"Skip 15 seconds",onAction:async()=>{try{let te=(_?.progress_ms||0)/1e3;await ka(te+15),await O()}catch(te){let qe=C(te);(0,S.showHUD)(qe)}}}),(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.RotateAntiClockwise,title:"Back 15 seconds",onAction:async()=>{try{let te=(_?.progress_ms||0)/1e3;await ka(te-15),await O()}catch(te){let qe=C(te);(0,S.showHUD)(qe)}}})]})}return(0,v.jsxs)(S.MenuBarExtra,{isLoading:f||E||E,icon:s==="cover-image"&&U?{source:U,mask:S.Image.Mask.RoundedRectangle}:{source:{dark:"menu-icon-dark.svg",light:"menu-icon-light.svg"}},title:ae,tooltip:ae,children:[$&&(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.Pause,title:"Pause",onAction:async()=>{try{await zo(),await b()}catch(F){let K=C(F);(0,S.showHUD)(K)}}}),!$&&(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.Play,title:"Play",onAction:async()=>{try{await Xo(),await b()}catch(F){let K=C(F);(0,S.showHUD)(K)}}}),se,(0,v.jsx)(S.MenuBarExtra.Submenu,{icon:S.Icon.List,title:"Add to Playlist",children:P?.items?.filter(F=>F.owner?.id===j?.id).map(F=>F.name&&F.id&&(0,v.jsx)(S.MenuBarExtra.Item,{title:F.name,onAction:async()=>{try{await mi({playlistId:F.id,trackUris:[ue]}),(0,S.showHUD)(`Added to ${F.name}`)}catch(K){let te=C(K);(0,S.showHUD)(te)}}},F.id))}),R?.devices&&(0,v.jsx)(S.MenuBarExtra.Submenu,{icon:S.Icon.Mobile,title:"Connect Device",children:R?.devices?.filter(F=>!F.is_restricted).map(F=>(0,v.jsx)(S.MenuBarExtra.Item,{title:F.name,icon:F.is_active?{source:S.Icon.SpeakerOn,tintColor:S.Color.Green}:{source:S.Icon.SpeakerOff,tintColor:S.Color.SecondaryText},onAction:async()=>{if(F.id)try{await oi(F.id,!!$)}catch(K){let te=C(K);(0,S.showHUD)(te)}await(0,S.showHUD)(`Connected to ${F.name}`)}},F.id))}),(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{icon:S.Icon.ArrowsExpand,title:"Now Playing",onAction:()=>(0,S.launchCommand)({name:"nowPlaying",type:S.LaunchType.UserInitiated})})}),(0,v.jsxs)(S.MenuBarExtra.Section,{children:[(0,v.jsx)(S.MenuBarExtra.Item,{title:"Copy URL",icon:S.Icon.Link,shortcut:{macOS:{modifiers:["cmd","shift"],key:"c"},Windows:{modifiers:["ctrl","shift"],key:"c"}},onAction:async()=>{await S.Clipboard.copy({html:`<a href=${J?.spotify}>${ae}</a>`,text:J?.spotify}),(0,S.showHUD)("Copied URL to clipboard")}}),(0,v.jsx)(S.MenuBarExtra.Item,{icon:"spotify-icon.svg",title:"Open on Spotify",shortcut:S.Keyboard.Shortcut.Common.Open,onAction:()=>Mt?(0,S.open)(ue||"spotify"):(0,S.open)(J?.spotify||"https://play.spotify.com")})]}),(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:"Configure Command",shortcut:{macOS:{modifiers:["cmd"],key:","},Windows:{modifiers:["ctrl"],key:","}},onAction:S.openCommandPreferences})})]})}function Dd({isLoading:r}){return(0,S.getPreferenceValues)().hideIconWhenIdle?null:(0,v.jsxs)(S.MenuBarExtra,{icon:{source:{dark:"menu-icon-dark.svg",light:"menu-icon-light.svg"}},isLoading:r,children:[(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:"Spotify needs to be opened"})}),(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:"Open Spotify",icon:"spotify-icon.svg",onAction:()=>Mt?(0,S.open)("spotify:"):(0,S.open)("https://play.spotify.com")})}),(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:"Configure Command",shortcut:{macOS:{modifiers:["cmd"],key:","},Windows:{modifiers:["ctrl"],key:","}},onAction:S.openCommandPreferences})})]})}function Ld({title:r="Nothing is playing right now",isLoading:t}){return(0,S.getPreferenceValues)().hideIconWhenIdle?null:(0,v.jsxs)(S.MenuBarExtra,{icon:{source:{dark:"menu-icon-dark.svg",light:"menu-icon-light.svg"}},isLoading:t,children:[(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:r})}),(0,v.jsxs)(S.MenuBarExtra.Section,{children:[(0,v.jsx)(S.MenuBarExtra.Item,{title:"Your library",icon:S.Icon.Book,onAction:()=>(0,S.launchCommand)({name:"yourLibrary",type:S.LaunchType.UserInitiated})}),(0,v.jsx)(S.MenuBarExtra.Item,{title:"Search",icon:S.Icon.MagnifyingGlass,onAction:()=>(0,S.launchCommand)({name:"search",type:S.LaunchType.UserInitiated})})]}),(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:"Open Spotify",icon:"spotify-icon.svg",onAction:()=>Mt?(0,S.open)("spotify:"):(0,S.open)("https://play.spotify.com")})}),(0,v.jsx)(S.MenuBarExtra.Section,{children:(0,v.jsx)(S.MenuBarExtra.Item,{title:"Configure Command",shortcut:{macOS:{modifiers:["cmd"],key:","},Windows:{modifiers:["ctrl"],key:","}},onAction:S.openCommandPreferences})})]})}function ki(r){return(0,v.jsx)(di,{children:(0,v.jsx)(qd,{...r})})}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
